<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-bounce.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.hongjy.cn","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"always","padding":18,"offset":12,"onmobile":true},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="1、概述log4net是.Net下一个非常优秀的开源日志记录组件。log4net记录日志的功能非常强大。它可以将日志分不同的等级，以不同的格式，输出到不同的媒介。本文主要是介绍如何在Visual Studio2008中使用log4net快速创建系统日志，如何扩展以输出自定义字段。">
<meta property="og:type" content="article">
<meta property="og:title" content="Log4net使用详细说明">
<meta property="og:url" content="http://www.hongjy.cn/2021/11/13/2021-11-13-Log4net%E4%BD%BF%E7%94%A8%E8%AF%A6%E7%BB%86%E8%AF%B4%E6%98%8E/index.html">
<meta property="og:site_name" content="花生了什么树的博客">
<meta property="og:description" content="1、概述log4net是.Net下一个非常优秀的开源日志记录组件。log4net记录日志的功能非常强大。它可以将日志分不同的等级，以不同的格式，输出到不同的媒介。本文主要是介绍如何在Visual Studio2008中使用log4net快速创建系统日志，如何扩展以输出自定义字段。">
<meta property="og:locale">
<meta property="article:published_time" content="2021-11-13T09:06:09.000Z">
<meta property="article:modified_time" content="2023-06-06T12:33:37.174Z">
<meta property="article:author" content="花生了什么树">
<meta property="article:tag" content=".NET工程师 后端开发">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://www.hongjy.cn/2021/11/13/2021-11-13-Log4net%E4%BD%BF%E7%94%A8%E8%AF%A6%E7%BB%86%E8%AF%B4%E6%98%8E/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-Hans'
  };
</script>

  <title>Log4net使用详细说明 | 花生了什么树的博客</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?749761669bb5184278820a5fa5d144a9";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>
    <!--github 挂饰-->
    <a target="_blank" rel="noopener" href="https://github.com/allenHongjun" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#fff; color:#151513; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">花生了什么树的博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">修身治国齐家平天下</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于我</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>日程表</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://www.hongjy.cn/2021/11/13/2021-11-13-Log4net%E4%BD%BF%E7%94%A8%E8%AF%A6%E7%BB%86%E8%AF%B4%E6%98%8E/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="http://blogimg.hongjy.cn/v2-a6137a264b6b78a3f1bdce115cf7c224_720w.jpg">
      <meta itemprop="name" content="花生了什么树">
      <meta itemprop="description" content=".NET工程师">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="花生了什么树的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Log4net使用详细说明
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-11-13 17:06:09" itemprop="dateCreated datePublished" datetime="2021-11-13T17:06:09+08:00">2021-11-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-06-06 20:33:37" itemprop="dateModified" datetime="2023-06-06T20:33:37+08:00">2023-06-06</time>
              </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>51k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>46 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="1、概述"><a href="#1、概述" class="headerlink" title="1、概述"></a>1、概述</h1><p>log4net是.Net下一个非常优秀的开源日志记录组件。log4net记录日志的功能非常强大。它可以将日志分不同的等级，以不同的格式，输出到不同的媒介。本文主要是介绍如何在Visual Studio2008中使用log4net快速创建系统日志，如何扩展以输出自定义字段。</p>
<a id="more"></a>



<h1 id="2、一个简单的使用实例"><a href="#2、一个简单的使用实例" class="headerlink" title="2、一个简单的使用实例"></a>2、一个简单的使用实例</h1><p><strong>第一步：</strong>在项目中添加对log4net.dll的引用，这里引用版本是1.2.10.0。</p>
<p><strong>第二步：</strong>程序启动时读取log4net的配置文件。</p>
<p>如果是CS程序，在根目录的Program.cs中的Main方法中添加：</p>
<p>log4net.Config.XmlConfigurator.Configure();</p>
<p>如果是BS程序，在根目录的Global.asax.cs（没有新建一个）中的Application_Start方法中添加：</p>
<p>log4net.Config.XmlConfigurator.Configure();</p>
<p>无论BS还是CS程序都可直接在项目的AssemblyInfo.cs文件里添加以下的语句：</p>
<p>[assembly: log4net.Config .XmlConfigurator()]</p>
<p>也可以使用自定义的配置文件，具体请参见4.4 关联配置文件。</p>
<p><strong>第三步：</strong>修改配置文件。如果是CS程序，则在默认的App.config文件（没有新建一个）中添加内容；如果是BS程序，则添加到Web.config文件中，添加内容一样，这里不再列出。</p>
<p>App.config文件添加内容如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"> 1 <span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span></span><br><span class="line"> 2 </span><br><span class="line"> 3 <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"> 4 </span><br><span class="line"> 5   <span class="tag">&lt;<span class="name">configSections</span>&gt;</span></span><br><span class="line"> 6 </span><br><span class="line"> 7 <span class="tag">&lt;<span class="name">section</span> <span class="attr">name</span>=<span class="string">&quot;log4net&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">8</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">9</span> <span class="attr">type</span>=<span class="string">&quot;log4net.Config.Log4NetConfigurationSectionHandler, log4net&quot;</span> /&gt;</span></span><br><span class="line">10 </span><br><span class="line">11   <span class="tag">&lt;/<span class="name">configSections</span>&gt;</span></span><br><span class="line">12 </span><br><span class="line">13  </span><br><span class="line">14 </span><br><span class="line">15   <span class="tag">&lt;<span class="name">log4net</span>&gt;</span></span><br><span class="line">16 </span><br><span class="line">17     <span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line">18 </span><br><span class="line">19       <span class="tag">&lt;<span class="name">level</span> <span class="attr">value</span>=<span class="string">&quot;WARN&quot;</span> /&gt;</span></span><br><span class="line">20 </span><br><span class="line">21       <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;LogFileAppender&quot;</span> /&gt;</span></span><br><span class="line">22 </span><br><span class="line">23       <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;ConsoleAppender&quot;</span> /&gt;</span></span><br><span class="line">24 </span><br><span class="line">25     <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line">26 </span><br><span class="line">27  </span><br><span class="line">28 </span><br><span class="line">29     <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;testApp.Logging&quot;</span>&gt;</span></span><br><span class="line">30 </span><br><span class="line">31       <span class="tag">&lt;<span class="name">level</span> <span class="attr">value</span>=<span class="string">&quot;DEBUG&quot;</span>/&gt;</span></span><br><span class="line">32 </span><br><span class="line">33     <span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line">34 </span><br><span class="line">35  </span><br><span class="line">36 </span><br><span class="line">37     <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;LogFileAppender&quot;</span> <span class="attr">type</span>=<span class="string">&quot;log4net.Appender.FileAppender&quot;</span> &gt;</span></span><br><span class="line">38 </span><br><span class="line">39       <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;File&quot;</span> <span class="attr">value</span>=<span class="string">&quot;log-file.txt&quot;</span> /&gt;</span></span><br><span class="line">40 </span><br><span class="line">41       <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;AppendToFile&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">42 </span><br><span class="line">43  </span><br><span class="line">44 </span><br><span class="line">45       <span class="tag">&lt;<span class="name">layout</span> <span class="attr">type</span>=<span class="string">&quot;log4net.Layout.PatternLayout&quot;</span>&gt;</span></span><br><span class="line">46 </span><br><span class="line">47         <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;Header&quot;</span> <span class="attr">value</span>=<span class="string">&quot;[Header] &quot;</span>/&gt;</span></span><br><span class="line">48 </span><br><span class="line">49         <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;Footer&quot;</span> <span class="attr">value</span>=<span class="string">&quot;[Footer] &quot;</span>/&gt;</span></span><br><span class="line">50 </span><br><span class="line">51         <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;ConversionPattern&quot;</span> <span class="attr">value</span>=<span class="string">&quot;%d [%t] %-5p %c [%x]  - %m%n&quot;</span> /&gt;</span></span><br><span class="line">52 </span><br><span class="line">53       <span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">54 </span><br><span class="line">55  </span><br><span class="line">56 </span><br><span class="line">57       <span class="tag">&lt;<span class="name">filter</span> <span class="attr">type</span>=<span class="string">&quot;log4net.Filter.LevelRangeFilter&quot;</span>&gt;</span></span><br><span class="line">58 </span><br><span class="line">59         <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;LevelMin&quot;</span> <span class="attr">value</span>=<span class="string">&quot;DEBUG&quot;</span> /&gt;</span></span><br><span class="line">60 </span><br><span class="line">61         <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;LevelMax&quot;</span> <span class="attr">value</span>=<span class="string">&quot;WARN&quot;</span> /&gt;</span></span><br><span class="line">62 </span><br><span class="line">63       <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">64 </span><br><span class="line">65     <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">66 </span><br><span class="line">67  </span><br><span class="line">68 </span><br><span class="line">69     <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;ConsoleAppender&quot;</span>  <span class="attr">type</span>=<span class="string">&quot;log4net.Appender.ConsoleAppender&quot;</span> &gt;</span></span><br><span class="line">70 </span><br><span class="line">71       <span class="tag">&lt;<span class="name">layout</span> <span class="attr">type</span>=<span class="string">&quot;log4net.Layout.PatternLayout&quot;</span>&gt;</span></span><br><span class="line">72 </span><br><span class="line">73         <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;ConversionPattern&quot;</span>  <span class="attr">value</span>=<span class="string">&quot;%d [%t] %-5p %c [%x] - %m%n&quot;</span> /&gt;</span></span><br><span class="line">74 </span><br><span class="line">75       <span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">76 </span><br><span class="line">77     <span class="tag">&lt;/<span class="name">appender</span>&gt;</span> </span><br><span class="line">78 </span><br><span class="line">79   <span class="tag">&lt;/<span class="name">log4net</span>&gt;</span></span><br><span class="line">80 </span><br><span class="line">81 <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>第四步：</strong>在程序使用。</p>
<p>log4net.ILog log = log4net.LogManager.GetLogger(“testApp.Logging”);//获取一个日志记录器</p>
<p>log.Info(DateTime.Now.ToString() + “: login success”);//写入一条新log</p>
<p>这样就将信息同时输出到控制台和写入到文件名为“log-file.txt”的文件中，其中“log-file.txt”文件的路径是当前程序运行所在目录；也可以定义为绝对路径，配置如：</p>
<param name="File" value="C:/log-file.txt" />就写入C盘根目录下log-file.txt文件中

<h1 id="3、Log4net的主要组成部分"><a href="#3、Log4net的主要组成部分" class="headerlink" title="3、Log4net的主要组成部分"></a>3、Log4net的主要组成部分</h1><h2 id="3-1-Appenders"><a href="#3-1-Appenders" class="headerlink" title="3.1 Appenders"></a>3.1 Appenders</h2><p>Appenders用来定义日志的输出方式，即日志要写到那种介质上去。较常用的Log4net已经实现好了，直接在配置文件中调用即可，可参见上面配置文件例子；当然也可以自己写一个，需要从log4net.Appender.AppenderSkeleton类继承。它还可以通过配置Filters和Layout来实现日志的过滤和输出格式。</p>
<p>已经实现的输出方式有：</p>
<p>AdoNetAppender 将日志记录到数据库中。可以采用SQL和存储过程两种方式。</p>
<p>AnsiColorTerminalAppender 将日志高亮输出到ANSI终端。</p>
<p>AspNetTraceAppender 能用asp.net中Trace的方式查看记录的日志。</p>
<p>BufferingForwardingAppender 在输出到子Appenders之前先缓存日志事件。</p>
<p>ConsoleAppender 将日志输出到应用程序控制台。</p>
<p>EventLogAppender 将日志写到Windows Event Log。</p>
<p>FileAppender 将日志输出到文件。</p>
<p>ForwardingAppender 发送日志事件到子Appenders。</p>
<p>LocalSyslogAppender 将日志写到local syslog service (仅用于UNIX环境下)。</p>
<p>MemoryAppender 将日志存到内存缓冲区。</p>
<p>NetSendAppender 将日志输出到Windows Messenger service.这些日志信息将在用户终端的对话框中显示。</p>
<p>OutputDebugStringAppender 将日志输出到Debuger，如果程序没有Debuger，就输出到系统Debuger。如果系统Debuger也不可用，将忽略消息。</p>
<p>RemoteSyslogAppender 通过UDP网络协议将日志写到Remote syslog service。</p>
<p>RemotingAppender 通过.NET Remoting将日志写到远程接收端。</p>
<p>RollingFileAppender 将日志以回滚文件的形式写到文件中。</p>
<p>SmtpAppender 将日志写到邮件中。</p>
<p>SmtpPickupDirAppender 将消息以文件的方式放入一个目录中，像IIS SMTP agent这样的SMTP代理就可以阅读或发送它们。</p>
<p>TelnetAppender 客户端通过Telnet来接受日志事件。</p>
<p>TraceAppender 将日志写到.NET trace 系统。</p>
<p>UdpAppender 将日志以无连接UDP数据报的形式送到远程宿主或用UdpClient的形式广播。</p>
<h2 id="3-2-Filters"><a href="#3-2-Filters" class="headerlink" title="3.2 Filters"></a>3.2 Filters</h2><p>使用过滤器可以过滤掉Appender输出的内容。过滤器通常有以下几种：</p>
<p>DenyAllFilter 阻止所有的日志事件被记录</p>
<p>LevelMatchFilter 只有指定等级的日志事件才被记录</p>
<p>LevelRangeFilter 日志等级在指定范围内的事件才被记录</p>
<p>LoggerMatchFilter 与Logger名称匹配，才记录</p>
<p>PropertyFilter 消息匹配指定的属性值时才被记录</p>
<p>StringMathFilter 消息匹配指定的字符串才被记录</p>
<h2 id="3-3-Layouts"><a href="#3-3-Layouts" class="headerlink" title="3.3 Layouts"></a>3.3 Layouts</h2><p>Layout用于控制Appender的输出格式，可以是线性的也可以是XML。</p>
<p>一个Appender只能有一个Layout。</p>
<p>最常用的Layout应该是经典格式的<strong>PatternLayout</strong>，其次是SimpleLayout，<strong>RawTimeStampLayout</strong>和ExceptionLayout。然后还有IRawLayout，XMLLayout等几个，使用较少。Layout可以自己实现，需要从log4net.Layout.LayoutSkeleton类继承，来输出一些特殊需要的格式，在后面扩展时就重新实现了一个Layout。</p>
<p>SimpleLayout简单输出格式，只输出日志级别与消息内容。</p>
<p><strong>RawTimeStampLayout</strong> 用来格式化时间，在向数据库输出时会用到。</p>
<p>样式如“yyyy-MM-dd HH:mm:ss“</p>
<p>ExceptionLayout需要给Logger的方法传入Exception对象作为参数才起作用，否则就什么也不输出。输出的时候会包含Message和Trace。</p>
<p>PatterLayout使用最多的一个Layout，能输出的信息很多，使用方式可参见上面例子中的配置文件。PatterLayout的格式化字符串见文后附注8.1。</p>
<h2 id="3-4-Loggers"><a href="#3-4-Loggers" class="headerlink" title="3.4 Loggers"></a>3.4 Loggers</h2><p>Logger是直接和应用程序交互的组件。Logger只是产生日志，然后由它引用的Appender记录到指定的媒介，并由Layout控制输出格式。</p>
<p>Logger提供了多种方式来记录一个日志消息，也可以有多个Logger同时存在。每个实例化的Logger对象对被log4net作为命名实体（Named Entity）来维护。log4net使用继承体系，也就是说假如存在两个Logger，名字分别为a.b.c和a.b。那么a.b就是a.b.c的祖先。每个Logger都继承了它祖先的属性。所有的Logger都从Root继承,Root本身也是一个Logger。</p>
<p>日志的等级，它们由高到底分别为：</p>
<p>OFF &gt; FATAL &gt; ERROR &gt; WARN &gt; INFO &gt; DEBUG &gt; ALL </p>
<p>高于等级设定值方法（如何设置参见“配置文件详解”）都能写入日志， Off所有的写入方法都不写到日志里，ALL则相反。例如当我们设成Info时，logger.Debug就会被忽略而不写入文件，但是FATAL,ERROR,WARN,INFO会被写入，因为他们等级高于INFO。</p>
<p>在具体写日志时，一般可以这样理解日志等级：</p>
<p>FATAL（致命错误）：记录系统中出现的能使用系统完全失去功能，服务停止，系统崩溃等使系统无法继续运行下去的错误。例如，数据库无法连接，系统出现死循环。</p>
<p>ERROR（一般错误）：记录系统中出现的导致系统不稳定，部分功能出现混乱或部分功能失效一类的错误。例如，数据字段为空，数据操作不可完成，操作出现异常等。</p>
<p>WARN（警告）：记录系统中不影响系统继续运行，但不符合系统运行正常条件，有可能引起系统错误的信息。例如，记录内容为空，数据内容不正确等。</p>
<p>INFO（一般信息）：记录系统运行中应该让用户知道的基本信息。例如，服务开始运行，功能已经开户等。</p>
<p>DEBUG （调试信息）：记录系统用于调试的一切信息，内容或者是一些关键数据内容的输出。</p>
<p>Logger实现的ILog接口，ILog定义了5个方法（Debug,Inof,Warn,Error,Fatal）分别对不同的日志等级记录日志。这5个方法还有5个重载。以Debug为例说明一下，其它的和它差不多。</p>
<p>ILog中对Debug方法的定义如下：</p>
<p>void Debug(object message);</p>
<p>void Debug(object message, Exception ex);</p>
<p>还有一个布尔属性：</p>
<p>bool IsDebugEnabled { get; }</p>
<p>如果使用Debug(object message, Exception ex)，则无论Layout中是否定义了%exception，默认配置下日志都会输出Exception。包括Exception的Message和Trace。如果使用Debug(object message)，则日志是不会输出Exception。</p>
<p>最后还要说一个LogManager类，它用来管理所有的Logger。它的GetLogger静态方法，可以获得配置文件中相应的Logger：</p>
<p>log4net.ILog log = log4net.LogManager.GetLogger(“logger-name”);</p>
<h2 id="3-5-Object-Renders"><a href="#3-5-Object-Renders" class="headerlink" title="3.5 Object Renders"></a>3.5 Object Renders</h2><p>它将告诉logger如何把一个对象转化为一个字符串记录到日志里。（ILog中定义的接口接收的参数是Object，而不是String。）</p>
<p>例如你想把Orange对象记录到日志中，但此时logger只会调用Orange默认的ToString方法而已。所以要定义一个OrangeRender类实现log4net.ObjectRender.IObjectRender接口，然后注册它（我们在本文中的扩展不使用这种方法，而是直接实现一个自定义的Layout）。这时logger就会知道如何把Orange记录到日志中了。</p>
<h2 id="3-6-Repository"><a href="#3-6-Repository" class="headerlink" title="3.6 Repository"></a>3.6 Repository</h2><p>Repository主要用于日志对象组织结构的维护。</p>
<h1 id="4、配置文件详解"><a href="#4、配置文件详解" class="headerlink" title="4、配置文件详解"></a>4、配置文件详解</h1><h2 id="4-1-配置文件构成"><a href="#4-1-配置文件构成" class="headerlink" title="4.1 配置文件构成"></a>4.1 配置文件构成</h2><p>主要有两大部分，一是申明一个名为“log4net“的自定义配置节，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1 <span class="tag">&lt;<span class="name">configSections</span>&gt;</span></span><br><span class="line">2 </span><br><span class="line">3 <span class="tag">&lt;<span class="name">section</span> <span class="attr">name</span>=<span class="string">&quot;log4net&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">4</span> </span></span><br><span class="line"><span class="tag"><span class="attr">5</span> <span class="attr">type</span>=<span class="string">&quot;log4net.Config.Log4NetConfigurationSectionHandler, log4net&quot;</span> /&gt;</span></span><br><span class="line">6 </span><br><span class="line">7   <span class="tag">&lt;/<span class="name">configSections</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>二是<log4net>节的具体配置，这是下面要重点说明的。</p>
<h3 id="4-1-1"><a href="#4-1-1" class="headerlink" title="4.1.1"></a>4.1.1<log4net></h3><p>所有的配置都要在<log4net>元素里定义。</p>
<p>支持的属性：</p>
<table>
<thead>
<tr>
<th>debug</th>
<th>可选，取值是true或false，默认是false。设置为true，开启log4net的内部调试。</th>
</tr>
</thead>
<tbody><tr>
<td>update</td>
<td>可选，取值是Merge(合并)或Overwrite(覆盖)，默认值是Merge。设置为Overwrite，在提交配置的时候会重置已经配置过的库。</td>
</tr>
<tr>
<td>threshold</td>
<td>可选，取值是repository（库）中注册的level，默认值是ALL。</td>
</tr>
</tbody></table>
<p>支持的子元素：</p>
<table>
<thead>
<tr>
<th>appender</th>
<th>0或多个</th>
</tr>
</thead>
<tbody><tr>
<td>logger</td>
<td>0或多个</td>
</tr>
<tr>
<td>renderer</td>
<td>0或多个</td>
</tr>
<tr>
<td>root</td>
<td>最多一个</td>
</tr>
<tr>
<td>param</td>
<td>0或多个</td>
</tr>
</tbody></table>
<h3 id="4-1-2"><a href="#4-1-2" class="headerlink" title="4.1.2 "></a>4.1.2 <root></h3><p>实际上就是一个根logger，所有其它logger都默认继承它，如果配置文件里没有显式定义，则框架使用根日志中定义的属性。root元素没有属性。</p>
<p>支持的子元素：</p>
<table>
<thead>
<tr>
<th>appender-ref</th>
<th>0个或多个，要引用的appender的名字。</th>
</tr>
</thead>
<tbody><tr>
<td>level</td>
<td>最多一个。 只有在这个级别或之上的事件才会被记录。</td>
</tr>
<tr>
<td>param</td>
<td>0个或多个， 设置一些参数。</td>
</tr>
</tbody></table>
<h3 id="4-1-3"><a href="#4-1-3" class="headerlink" title="4.1.3 "></a>4.1.3 <logger></h3><p>支持的属性：</p>
<table>
<thead>
<tr>
<th>name</th>
<th>必须的，logger的名称</th>
</tr>
</thead>
<tbody><tr>
<td>additivity</td>
<td>可选，取值是true或false，默认值是true。设置为false时将阻止父logger中的appender。</td>
</tr>
</tbody></table>
<p>支持的子元素：</p>
<table>
<thead>
<tr>
<th>appender-ref</th>
<th>0个或多个，要引用的appender的名字。</th>
</tr>
</thead>
<tbody><tr>
<td>level</td>
<td>最多一个。 只有在这个级别或之上的事件才会被记录。</td>
</tr>
<tr>
<td>param</td>
<td>0个或多个， 设置一些参数。</td>
</tr>
</tbody></table>
<h3 id="4-1-4"><a href="#4-1-4" class="headerlink" title="4.1.4 "></a>4.1.4 <appender></h3><p>定义日志的输出方式，只能作为 log4net 的子元素。name属性必须唯一，type属性必须指定。</p>
<p>支持的属性：</p>
<table>
<thead>
<tr>
<th>name</th>
<th>必须的，Appender对象的名称</th>
</tr>
</thead>
<tbody><tr>
<td>type</td>
<td>必须的，Appender对象的输出类型</td>
</tr>
</tbody></table>
<p>支持的子元素：</p>
<table>
<thead>
<tr>
<th>appender-ref</th>
<th>0个或多个，允许此appender引用其他appender，并不是所以appender类型都支持。</th>
</tr>
</thead>
<tbody><tr>
<td>filter</td>
<td>0个或多个，定义此app使用的过滤器。</td>
</tr>
<tr>
<td>layout</td>
<td>最多一个。定义appender使用的输出格式。</td>
</tr>
<tr>
<td>param</td>
<td>0个或多个， 设置Appender类中对应的属性的值。</td>
</tr>
</tbody></table>
<p>实际上<appender>所能包含的子元素远不止上面4个。</p>
<h3 id="4-1-5"><a href="#4-1-5" class="headerlink" title="4.1.5 "></a>4.1.5 <layout></h3><p>布局，只能作为<appender>的子元素。</p>
<p>支持的属性：</p>
<table>
<thead>
<tr>
<th>type</th>
<th>必须的，Layout的类型</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>支持的子元素：</p>
<table>
<thead>
<tr>
<th>param</th>
<th>0个或多个， 设置一些参数。</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="4-1-6"><a href="#4-1-6" class="headerlink" title="4.1.6 "></a>4.1.6 <filter></h3><p>过滤器，只能作为<appender>的子元素。</p>
<p>支持的属性：</p>
<table>
<thead>
<tr>
<th>type</th>
<th>必须的，Filter的类型</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>支持的子元素：</p>
<table>
<thead>
<tr>
<th>param</th>
<th>0个或多个， 设置一些参数。</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="4-1-7"><a href="#4-1-7" class="headerlink" title="4.1.7 "></a>4.1.7 <param></h3><param>元素可以是任何元素的子元素。

<p>支持的属性：</p>
<table>
<thead>
<tr>
<th>name</th>
<th>必须的，取值是父对象的参数名。</th>
</tr>
</thead>
<tbody><tr>
<td>value</td>
<td>可选的，value和type中，必须有一个属性被指定。value是一个能被转化为参数值的字符串。</td>
</tr>
<tr>
<td>type</td>
<td>可选的，value和type中，必须有一个属性被指定。type是一个类型名，如果type不是在log4net程序集中定义的，就需要使用全名。</td>
</tr>
</tbody></table>
<p>支持的子元素：</p>
<table>
<thead>
<tr>
<th>param</th>
<th>0个或多个， 设置一些参数。</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<h2 id="4-2-配置"><a href="#4-2-配置" class="headerlink" title="4.2 配置"></a>4.2 <appender>配置</h2><p>  <appender>在配置文件中至少有一个，也可以有多个，有些<appender>类型还可以引用其他<appender>类型，具体参数可参见上表。</p>
<p>下面只对写入回滚文件与输出到数据库（这里使用SQL数据库）配置体会说一下，其他配置可参考官方网站：<a target="_blank" rel="noopener" href="http://logging.apache.org/log4net/release/config-examples.html">http://logging.apache.org/log4net/release/config-examples.html</a></p>
<h3 id="4-2-1写入回滚文件"><a href="#4-2-1写入回滚文件" class="headerlink" title="4.2.1写入回滚文件"></a>4.2.1写入回滚文件</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line">  1  <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;ReflectionLayout&quot;</span> <span class="attr">type</span>=<span class="string">&quot;log4net.Appender.RollingFileAppender,log4net&quot;</span>&gt;</span></span><br><span class="line">  2 </span><br><span class="line">  3 <span class="comment">&lt;!--日志文件路径，“/”与“/”作用相同，到达的目录相同，文件夹不存在则新建 --&gt;</span></span><br><span class="line">  4 </span><br><span class="line">  5 <span class="comment">&lt;!--按文件大小方式输出时在这里指定文件名，并且当天的日志在下一天时在文件名后自动追加当天日期形成新文件。--&gt;</span></span><br><span class="line">  6 </span><br><span class="line">  7 <span class="tag">&lt;<span class="name">!—按照日期形式输出时，直接连接元素DatePattern的value形成文件路径。此处使用这种方式</span> <span class="attr">--</span>&gt;</span></span><br><span class="line">  8 </span><br><span class="line">  9 <span class="comment">&lt;!--param的名称,可以直接查对应的appender类的属性名即可,这里要查的就是RollingFileAppender类的属性 --&gt;</span></span><br><span class="line"> 10 </span><br><span class="line"> 11       <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;File&quot;</span> <span class="attr">value</span>=<span class="string">&quot;D:/Log/&quot;</span> /&gt;</span></span><br><span class="line"> 12 </span><br><span class="line"> 13  </span><br><span class="line"> 14 </span><br><span class="line"> 15       <span class="comment">&lt;!--是否追加到文件--&gt;</span></span><br><span class="line"> 16 </span><br><span class="line"> 17       <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;AppendToFile&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line"> 18 </span><br><span class="line"> 19  </span><br><span class="line"> 20 </span><br><span class="line"> 21       <span class="comment">&lt;!--记录日志写入文件时，不锁定文本文件，防止多线程时不能写Log,官方说线程非安全--&gt;</span></span><br><span class="line"> 22 </span><br><span class="line"> 23       <span class="tag">&lt;<span class="name">lockingModel</span> <span class="attr">type</span>=<span class="string">&quot;log4net.Appender.FileAppender+MinimalLock&quot;</span> /&gt;</span></span><br><span class="line"> 24 </span><br><span class="line"> 25  </span><br><span class="line"> 26 </span><br><span class="line"> 27       <span class="tag">&lt;<span class="name">!—使用Unicode编码--</span>&gt;</span></span><br><span class="line"> 28 </span><br><span class="line"> 29       <span class="tag">&lt;<span class="name">Encoding</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line"> 30 </span><br><span class="line"> 31  </span><br><span class="line"> 32 </span><br><span class="line"> 33       <span class="comment">&lt;!--最多产生的日志文件数，超过则只保留最新的n个。设定值value=&quot;－1&quot;为不限文件数--&gt;</span></span><br><span class="line"> 34 </span><br><span class="line"> 35       <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;MaxSizeRollBackups&quot;</span> <span class="attr">value</span>=<span class="string">&quot;10&quot;</span> /&gt;</span></span><br><span class="line"> 36 </span><br><span class="line"> 37  </span><br><span class="line"> 38 </span><br><span class="line"> 39       <span class="comment">&lt;!--是否只写到一个文件中--&gt;</span></span><br><span class="line"> 40 </span><br><span class="line"> 41       <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;StaticLogFileName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line"> 42 </span><br><span class="line"> 43  </span><br><span class="line"> 44 </span><br><span class="line"> 45       <span class="comment">&lt;!--按照何种方式产生多个日志文件(日期[Date],文件大小[Size],混合[Composite])--&gt;</span></span><br><span class="line"> 46 </span><br><span class="line"> 47       <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;RollingStyle&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Composite&quot;</span> /&gt;</span></span><br><span class="line"> 48 </span><br><span class="line"> 49  </span><br><span class="line"> 50 </span><br><span class="line"> 51       <span class="comment">&lt;!--按日期产生文件夹和文件名［在日期方式与混合方式下使用］--&gt;</span></span><br><span class="line"> 52 </span><br><span class="line"> 53 <span class="tag">&lt;<span class="name">!—此处按日期产生文件夹，文件名固定。注意&amp;quot;</span> 的位置<span class="attr">--</span>&gt;</span></span><br><span class="line"> 54 </span><br><span class="line"> 55       <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;DatePattern&quot;</span> <span class="attr">value</span>=<span class="string">&quot;yyyy-MM-dd/<span class="symbol">&amp;quot;</span>ReflectionLayout.log<span class="symbol">&amp;quot;</span>&quot;</span>  /&gt;</span></span><br><span class="line"> 56 </span><br><span class="line"> 57 <span class="tag">&lt;<span class="name">!—这是按日期产生文件夹，并在文件名前也加上日期--</span>&gt;</span></span><br><span class="line"> 58 </span><br><span class="line"> 59       <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;DatePattern&quot;</span> <span class="attr">value</span>=<span class="string">&quot;yyyyMMdd/yyyyMMdd<span class="symbol">&amp;quot;</span>-TimerServer.log<span class="symbol">&amp;quot;</span>&quot;</span>  /&gt;</span></span><br><span class="line"> 60 </span><br><span class="line"> 61 <span class="tag">&lt;<span class="name">!—这是先按日期产生文件夹，再形成下一级固定的文件夹—</span>&gt;</span></span><br><span class="line"> 62 </span><br><span class="line"> 63       <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;DatePattern&quot;</span> <span class="attr">value</span>=<span class="string">&quot;yyyyMMdd/<span class="symbol">&amp;quot;</span>TimerServer/TimerServer.log<span class="symbol">&amp;quot;</span>&quot;</span>  /&gt;</span></span><br><span class="line"> 64 </span><br><span class="line"> 65  </span><br><span class="line"> 66 </span><br><span class="line"> 67       <span class="comment">&lt;!--每个文件的大小。只在混合方式与文件大小方式下使用。</span></span><br><span class="line"><span class="comment"> 68 </span></span><br><span class="line"><span class="comment"> 69 超出大小后在所有文件名后自动增加正整数重新命名，数字最大的最早写入。</span></span><br><span class="line"><span class="comment"> 70 </span></span><br><span class="line"><span class="comment"> 71 可用的单位:KB|MB|GB。不要使用小数,否则会一直写入当前日志--&gt;</span></span><br><span class="line"> 72 </span><br><span class="line"> 73       <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;maximumFileSize&quot;</span> <span class="attr">value</span>=<span class="string">&quot;500KB&quot;</span> /&gt;</span></span><br><span class="line"> 74 </span><br><span class="line"> 75  </span><br><span class="line"> 76 </span><br><span class="line"> 77 <span class="comment">&lt;!--计数类型为1，2，3…--&gt;</span></span><br><span class="line"> 78       <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;CountDirection&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span></span><br><span class="line"> 79 </span><br><span class="line"> 80  </span><br><span class="line"> 81 </span><br><span class="line"> 82 <span class="tag">&lt;<span class="name">!—过滤设置，LevelRangeFilter为使用的过滤器。</span> <span class="attr">--</span>&gt;</span></span><br><span class="line"> 83 </span><br><span class="line"> 84       <span class="tag">&lt;<span class="name">filter</span> <span class="attr">type</span>=<span class="string">&quot;log4net.Filter.LevelRangeFilter&quot;</span>&gt;</span></span><br><span class="line"> 85 </span><br><span class="line"> 86         <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;LevelMin&quot;</span> <span class="attr">value</span>=<span class="string">&quot;DEBUG&quot;</span> /&gt;</span></span><br><span class="line"> 87 </span><br><span class="line"> 88         <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;LevelMax&quot;</span> <span class="attr">value</span>=<span class="string">&quot;WARN&quot;</span> /&gt;</span></span><br><span class="line"> 89 </span><br><span class="line"> 90       <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"> 91 </span><br><span class="line"> 92  </span><br><span class="line"> 93 </span><br><span class="line"> 94       <span class="comment">&lt;!--记录的格式。一般用log4net.Layout.PatternLayout布局--&gt;</span></span><br><span class="line"> 95 </span><br><span class="line"> 96 <span class="tag">&lt;<span class="name">!—此处用继承了log4net.Layout.PatternLayout的自定义布局，TGLog.ExpandLayout2</span></span></span><br><span class="line"><span class="tag"> <span class="attr">97</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">98</span> 为命名空间。%<span class="attr">property</span>&#123;<span class="attr">Operator</span>&#125;、%<span class="attr">property</span>&#123;<span class="attr">Action</span>&#125;是自定义的输出<span class="attr">-</span>－&gt;</span></span><br><span class="line"> 99 </span><br><span class="line">100       <span class="tag">&lt;<span class="name">layout</span> <span class="attr">type</span>=<span class="string">&quot;TGLog.ExpandLayout2.ReflectionLayout,TGLog&quot;</span>&gt;</span></span><br><span class="line">101 </span><br><span class="line">102         <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;ConversionPattern&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">103</span> </span></span><br><span class="line"><span class="tag"><span class="attr">104</span>  <span class="attr">value</span>=<span class="string">&quot;记录时间：%date 线程ID:[%thread] 日志级别：%-5level 记录类：%logger     操作者ID：%property&#123;Operator&#125; 操作类型：%property&#123;Action&#125;%n             当前机器名:%property%n当前机器名及登录用户：%username %n               记录位置：%location%n 消息描述：%property&#123;Message&#125;%n                    异常：%exception%n 消息：%message%newline%n%n&quot;</span> /&gt;</span></span><br><span class="line">105 </span><br><span class="line">106       <span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">107 </span><br><span class="line">108 <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="4-2-1写入SQL数据库"><a href="#4-2-1写入SQL数据库" class="headerlink" title="4.2.1写入SQL数据库"></a>4.2.1写入SQL数据库</h3><p>需要在相应的数据库中准备好一张表，创建语句如下：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1</span> CREATE TABLE [Log] (</span><br><span class="line"> <span class="number">2</span> </span><br><span class="line"> <span class="number">3</span> [ID] [<span class="keyword">int</span>] IDENTITY (<span class="number">1</span>, <span class="number">1</span>) NOT NULL ,</span><br><span class="line"> <span class="number">4</span> </span><br><span class="line"> <span class="number">5</span> [Date] [datetime] NOT NULL ,</span><br><span class="line"> <span class="number">6</span> </span><br><span class="line"> <span class="number">7</span> [Thread] [varchar] (<span class="number">100</span>) COLLATE Chinese_PRC_CI_AS NULL ,</span><br><span class="line"> <span class="number">8</span> </span><br><span class="line"> <span class="number">9</span> [Level] [varchar] (<span class="number">100</span>) COLLATE Chinese_PRC_CI_AS NULL ,</span><br><span class="line"><span class="number">10</span> </span><br><span class="line"><span class="number">11</span> [Logger] [varchar] (<span class="number">200</span>) COLLATE Chinese_PRC_CI_AS NULL ,</span><br><span class="line"><span class="number">12</span> </span><br><span class="line"><span class="number">13</span> [Operator] [<span class="keyword">int</span>] NULL ,</span><br><span class="line"><span class="number">14</span> </span><br><span class="line"><span class="number">15</span> [Message] [text] COLLATE Chinese_PRC_CI_AS NULL ,</span><br><span class="line"><span class="number">16</span> </span><br><span class="line"><span class="number">17</span> [ActionType] [<span class="keyword">int</span>] NULL ,</span><br><span class="line"><span class="number">18</span> </span><br><span class="line"><span class="number">19</span> [Operand] [varchar] (<span class="number">300</span>) COLLATE Chinese_PRC_CI_AS NULL ,</span><br><span class="line"><span class="number">20</span> </span><br><span class="line"><span class="number">21</span> [IP] [varchar] (<span class="number">20</span>) COLLATE Chinese_PRC_CI_AS NULL ,</span><br><span class="line"><span class="number">22</span> </span><br><span class="line"><span class="number">23</span> [MachineName] [varchar] (<span class="number">100</span>) COLLATE Chinese_PRC_CI_AS NULL ,</span><br><span class="line"><span class="number">24</span> </span><br><span class="line"><span class="number">25</span> [Browser] [varchar] (<span class="number">50</span>) COLLATE Chinese_PRC_CI_AS NULL ,</span><br><span class="line"><span class="number">26</span> </span><br><span class="line"><span class="number">27</span> [Location] [text] COLLATE Chinese_PRC_CI_AS NULL ,</span><br><span class="line"><span class="number">28</span> </span><br><span class="line"><span class="number">29</span> [Exception] [text] COLLATE Chinese_PRC_CI_AS NULL</span><br><span class="line"><span class="number">30</span> </span><br><span class="line"><span class="number">31</span> )</span><br></pre></td></tr></table></figure>





<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br></pre></td><td class="code"><pre><span class="line">  1 <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;ADONetAppender&quot;</span> <span class="attr">type</span>=<span class="string">&quot;log4net.Appender.ADONetAppender,log4net&quot;</span>&gt;</span></span><br><span class="line">  2 </span><br><span class="line">  3 <span class="comment">&lt;!--BufferSize为缓冲区大小，只有日志记录超设定值才会一块写入到数据库--&gt;</span></span><br><span class="line">  4 </span><br><span class="line">  5 &lt;bufferSize value=&quot;10&quot; /&gt;&lt;!—或写为&lt;param name=&quot;BufferSize&quot; value=&quot;10&quot; /&gt;--&gt;</span><br><span class="line">  6 </span><br><span class="line">  7  </span><br><span class="line">  8 </span><br><span class="line">  9 <span class="comment">&lt;!--引用--&gt;</span></span><br><span class="line"> 10 </span><br><span class="line"> 11 <span class="tag">&lt;<span class="name">connectionType</span> <span class="attr">value</span>=<span class="string">&quot;System.Data.SqlClient.SqlConnection, System.Data, Version=1.0.3300.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;</span> /&gt;</span></span><br><span class="line"> 12 </span><br><span class="line"> 13  </span><br><span class="line"> 14 </span><br><span class="line"> 15 <span class="comment">&lt;!--连接数据库字符串--&gt;</span></span><br><span class="line"> 16 </span><br><span class="line"> 17 <span class="tag">&lt;<span class="name">connectionString</span> <span class="attr">value</span>=<span class="string">&quot;data source=.;initial catalog=Test;integrated security=false;persist security info=True;User ID=sa;Password=;&quot;</span> /&gt;</span></span><br><span class="line"> 18 </span><br><span class="line"> 19  </span><br><span class="line"> 20 </span><br><span class="line"> 21 <span class="comment">&lt;!--插入到表Log--&gt;</span></span><br><span class="line"> 22 </span><br><span class="line"> 23 <span class="tag">&lt;<span class="name">commandText</span> <span class="attr">value</span>=<span class="string">&quot;INSERT INTO Log ([Date],[Thread],[Level],[Logger],[Operator],[Message],[ActionType],[Operand],[IP],[MachineName],[Browser],[Location],[Exception]) VALUES (@log_date, @thread, @log_level, @logger,@operator, @message,@action_type,@operand,@ip,@machineName,@browser,@location,@exception)&quot;</span> /&gt;</span></span><br><span class="line"> 24 </span><br><span class="line"> 25  </span><br><span class="line"> 26 </span><br><span class="line"> 27 <span class="tag">&lt;<span class="name">!—日志记录时间，RawTimeStampLayout为默认的时间输出格式</span> <span class="attr">--</span>&gt;</span></span><br><span class="line"> 28 </span><br><span class="line"> 29       <span class="tag">&lt;<span class="name">parameter</span>&gt;</span></span><br><span class="line"> 30 </span><br><span class="line"> 31         <span class="tag">&lt;<span class="name">parameterName</span> <span class="attr">value</span>=<span class="string">&quot;@log_date&quot;</span> /&gt;</span></span><br><span class="line"> 32 </span><br><span class="line"> 33         <span class="tag">&lt;<span class="name">dbType</span> <span class="attr">value</span>=<span class="string">&quot;DateTime&quot;</span> /&gt;</span></span><br><span class="line"> 34 </span><br><span class="line"> 35         <span class="tag">&lt;<span class="name">layout</span> <span class="attr">type</span>=<span class="string">&quot;log4net.Layout.RawTimeStampLayout&quot;</span> /&gt;</span></span><br><span class="line"> 36 </span><br><span class="line"> 37       <span class="tag">&lt;/<span class="name">parameter</span>&gt;</span></span><br><span class="line"> 38 </span><br><span class="line"> 39  </span><br><span class="line"> 40 </span><br><span class="line"> 41       <span class="comment">&lt;!--线程号--&gt;</span></span><br><span class="line"> 42 </span><br><span class="line"> 43       <span class="tag">&lt;<span class="name">parameter</span>&gt;</span></span><br><span class="line"> 44 </span><br><span class="line"> 45         <span class="tag">&lt;<span class="name">parameterName</span> <span class="attr">value</span>=<span class="string">&quot;@thread&quot;</span> /&gt;</span></span><br><span class="line"> 46 </span><br><span class="line"> 47         <span class="tag">&lt;<span class="name">dbType</span> <span class="attr">value</span>=<span class="string">&quot;String&quot;</span> /&gt;</span></span><br><span class="line"> 48 </span><br><span class="line"> 49 <span class="tag">&lt;<span class="name">!—长度不可以省略，否则不会输出--</span>&gt;</span></span><br><span class="line"> 50 </span><br><span class="line"> 51         <span class="tag">&lt;<span class="name">size</span> <span class="attr">value</span>=<span class="string">&quot;100&quot;</span> /&gt;</span></span><br><span class="line"> 52 </span><br><span class="line"> 53         <span class="tag">&lt;<span class="name">layout</span> <span class="attr">type</span>=<span class="string">&quot;log4net.Layout.PatternLayout&quot;</span>&gt;</span></span><br><span class="line"> 54 </span><br><span class="line"> 55           <span class="tag">&lt;<span class="name">conversionPattern</span> <span class="attr">value</span>=<span class="string">&quot;%thread&quot;</span> /&gt;</span></span><br><span class="line"> 56 </span><br><span class="line"> 57         <span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line"> 58 </span><br><span class="line"> 59       <span class="tag">&lt;/<span class="name">parameter</span>&gt;</span></span><br><span class="line"> 60 </span><br><span class="line"> 61  </span><br><span class="line"> 62 </span><br><span class="line"> 63       <span class="comment">&lt;!--日志等级--&gt;</span></span><br><span class="line"> 64 </span><br><span class="line"> 65       <span class="tag">&lt;<span class="name">parameter</span>&gt;</span></span><br><span class="line"> 66 </span><br><span class="line"> 67         <span class="tag">&lt;<span class="name">parameterName</span> <span class="attr">value</span>=<span class="string">&quot;@log_level&quot;</span> /&gt;</span></span><br><span class="line"> 68 </span><br><span class="line"> 69         <span class="tag">&lt;<span class="name">dbType</span> <span class="attr">value</span>=<span class="string">&quot;String&quot;</span> /&gt;</span></span><br><span class="line"> 70 </span><br><span class="line"> 71         <span class="tag">&lt;<span class="name">size</span> <span class="attr">value</span>=<span class="string">&quot;100&quot;</span> /&gt;</span></span><br><span class="line"> 72 </span><br><span class="line"> 73         <span class="tag">&lt;<span class="name">layout</span> <span class="attr">type</span>=<span class="string">&quot;log4net.Layout.PatternLayout&quot;</span>&gt;</span></span><br><span class="line"> 74 </span><br><span class="line"> 75           <span class="tag">&lt;<span class="name">conversionPattern</span> <span class="attr">value</span>=<span class="string">&quot;%level&quot;</span> /&gt;</span></span><br><span class="line"> 76 </span><br><span class="line"> 77         <span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line"> 78 </span><br><span class="line"> 79       <span class="tag">&lt;/<span class="name">parameter</span>&gt;</span></span><br><span class="line"> 80 </span><br><span class="line"> 81  </span><br><span class="line"> 82 </span><br><span class="line"> 83       <span class="comment">&lt;!--日志记录类名称--&gt;</span></span><br><span class="line"> 84 </span><br><span class="line"> 85       <span class="tag">&lt;<span class="name">parameter</span>&gt;</span></span><br><span class="line"> 86 </span><br><span class="line"> 87         <span class="tag">&lt;<span class="name">parameterName</span> <span class="attr">value</span>=<span class="string">&quot;@logger&quot;</span> /&gt;</span></span><br><span class="line"> 88 </span><br><span class="line"> 89         <span class="tag">&lt;<span class="name">dbType</span> <span class="attr">value</span>=<span class="string">&quot;String&quot;</span> /&gt;</span></span><br><span class="line"> 90 </span><br><span class="line"> 91         <span class="tag">&lt;<span class="name">size</span> <span class="attr">value</span>=<span class="string">&quot;200&quot;</span> /&gt;</span></span><br><span class="line"> 92 </span><br><span class="line"> 93         <span class="tag">&lt;<span class="name">layout</span> <span class="attr">type</span>=<span class="string">&quot;log4net.Layout.PatternLayout&quot;</span>&gt;</span></span><br><span class="line"> 94 </span><br><span class="line"> 95           <span class="tag">&lt;<span class="name">conversionPattern</span> <span class="attr">value</span>=<span class="string">&quot;%logger&quot;</span> /&gt;</span></span><br><span class="line"> 96 </span><br><span class="line"> 97         <span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line"> 98 </span><br><span class="line"> 99       <span class="tag">&lt;/<span class="name">parameter</span>&gt;</span></span><br><span class="line">100 </span><br><span class="line">101      </span><br><span class="line">102 </span><br><span class="line">103       <span class="comment">&lt;!--操作者。这个是自定义的输出字段，使用重新实现的布局器ReflectionLayout --&gt;</span></span><br><span class="line">104 </span><br><span class="line">105       <span class="tag">&lt;<span class="name">parameter</span>&gt;</span></span><br><span class="line">106 </span><br><span class="line">107         <span class="tag">&lt;<span class="name">parameterName</span> <span class="attr">value</span>=<span class="string">&quot;@operator&quot;</span> /&gt;</span></span><br><span class="line">108 </span><br><span class="line">109 &lt;!—设置为Int32时只有bufferSize的 value&lt;=&quot;1&quot;才正确输出，没有找出原因。--&gt;</span><br><span class="line">110 </span><br><span class="line">111         <span class="tag">&lt;<span class="name">dbType</span> <span class="attr">value</span>=<span class="string">&quot;Int16&quot;</span> /&gt;</span></span><br><span class="line">112 </span><br><span class="line">113         <span class="tag">&lt;<span class="name">layout</span> <span class="attr">type</span>=<span class="string">&quot;TGLog.ExpandLayout2.ReflectionLayout,TGLog&quot;</span>&gt;</span></span><br><span class="line">114 </span><br><span class="line">115           <span class="tag">&lt;<span class="name">conversionPattern</span> <span class="attr">value</span>=<span class="string">&quot;%property&#123;Operator&#125;&quot;</span> /&gt;</span></span><br><span class="line">116 </span><br><span class="line">117         <span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">118 </span><br><span class="line">119       <span class="tag">&lt;/<span class="name">parameter</span>&gt;</span></span><br><span class="line">120 </span><br><span class="line">121  </span><br><span class="line">122 </span><br><span class="line">123       <span class="comment">&lt;!--操作对象--&gt;</span></span><br><span class="line">124 </span><br><span class="line">125       <span class="tag">&lt;<span class="name">parameter</span>&gt;</span></span><br><span class="line">126 </span><br><span class="line">127         <span class="tag">&lt;<span class="name">parameterName</span> <span class="attr">value</span>=<span class="string">&quot;@operand&quot;</span> /&gt;</span></span><br><span class="line">128 </span><br><span class="line">129         <span class="tag">&lt;<span class="name">dbType</span> <span class="attr">value</span>=<span class="string">&quot;String&quot;</span> /&gt;</span></span><br><span class="line">130 </span><br><span class="line">131         <span class="tag">&lt;<span class="name">size</span> <span class="attr">value</span>=<span class="string">&quot;300&quot;</span> /&gt;</span></span><br><span class="line">132 </span><br><span class="line">133         <span class="tag">&lt;<span class="name">layout</span> <span class="attr">type</span>=<span class="string">&quot;TGLog.ExpandLayout2.ReflectionLayout,TGLog&quot;</span>&gt;</span></span><br><span class="line">134 </span><br><span class="line">135           <span class="tag">&lt;<span class="name">conversionPattern</span> <span class="attr">value</span>=<span class="string">&quot;%property&#123;Operand&#125;&quot;</span> /&gt;</span></span><br><span class="line">136 </span><br><span class="line">137         <span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">138 </span><br><span class="line">139       <span class="tag">&lt;/<span class="name">parameter</span>&gt;</span></span><br><span class="line">140 </span><br><span class="line">141  </span><br><span class="line">142 </span><br><span class="line">143       <span class="tag">&lt;<span class="name">!—IP地址--</span>&gt;</span></span><br><span class="line">144 </span><br><span class="line">145       <span class="tag">&lt;<span class="name">parameter</span>&gt;</span></span><br><span class="line">146 </span><br><span class="line">147         <span class="tag">&lt;<span class="name">parameterName</span> <span class="attr">value</span>=<span class="string">&quot;@ip&quot;</span> /&gt;</span></span><br><span class="line">148 </span><br><span class="line">149         <span class="tag">&lt;<span class="name">dbType</span> <span class="attr">value</span>=<span class="string">&quot;String&quot;</span> /&gt;</span></span><br><span class="line">150 </span><br><span class="line">151         <span class="tag">&lt;<span class="name">size</span> <span class="attr">value</span>=<span class="string">&quot;20&quot;</span> /&gt;</span></span><br><span class="line">152 </span><br><span class="line">153         <span class="tag">&lt;<span class="name">layout</span> <span class="attr">type</span>=<span class="string">&quot;TGLog.ExpandLayout2.ReflectionLayout,TGLog&quot;</span>&gt;</span></span><br><span class="line">154 </span><br><span class="line">155           <span class="tag">&lt;<span class="name">conversionPattern</span> <span class="attr">value</span>=<span class="string">&quot;%property&#123;IP&#125;&quot;</span> /&gt;</span></span><br><span class="line">156 </span><br><span class="line">157         <span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">158 </span><br><span class="line">159       <span class="tag">&lt;/<span class="name">parameter</span>&gt;</span></span><br><span class="line">160 </span><br><span class="line">161  </span><br><span class="line">162 </span><br><span class="line">163       <span class="comment">&lt;!--机器名--&gt;</span></span><br><span class="line">164 </span><br><span class="line">165       <span class="tag">&lt;<span class="name">parameter</span>&gt;</span></span><br><span class="line">166 </span><br><span class="line">167         <span class="tag">&lt;<span class="name">parameterName</span> <span class="attr">value</span>=<span class="string">&quot;@machineName&quot;</span> /&gt;</span></span><br><span class="line">168 </span><br><span class="line">169         <span class="tag">&lt;<span class="name">dbType</span> <span class="attr">value</span>=<span class="string">&quot;String&quot;</span> /&gt;</span></span><br><span class="line">170 </span><br><span class="line">171         <span class="tag">&lt;<span class="name">size</span> <span class="attr">value</span>=<span class="string">&quot;100&quot;</span> /&gt;</span></span><br><span class="line">172 </span><br><span class="line">173         <span class="tag">&lt;<span class="name">layout</span> <span class="attr">type</span>=<span class="string">&quot;TGLog.ExpandLayout2.ReflectionLayout,TGLog&quot;</span>&gt;</span></span><br><span class="line">174 </span><br><span class="line">175           <span class="tag">&lt;<span class="name">conversionPattern</span> <span class="attr">value</span>=<span class="string">&quot;%property&#123;MachineName&#125;&quot;</span> /&gt;</span></span><br><span class="line">176 </span><br><span class="line">177         <span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">178 </span><br><span class="line">179       <span class="tag">&lt;/<span class="name">parameter</span>&gt;</span></span><br><span class="line">180 </span><br><span class="line">181  </span><br><span class="line">182 </span><br><span class="line">183       <span class="comment">&lt;!--浏览器--&gt;</span></span><br><span class="line">184 </span><br><span class="line">185       <span class="tag">&lt;<span class="name">parameter</span>&gt;</span></span><br><span class="line">186 </span><br><span class="line">187         <span class="tag">&lt;<span class="name">parameterName</span> <span class="attr">value</span>=<span class="string">&quot;@browser&quot;</span> /&gt;</span></span><br><span class="line">188 </span><br><span class="line">189         <span class="tag">&lt;<span class="name">dbType</span> <span class="attr">value</span>=<span class="string">&quot;String&quot;</span> /&gt;</span></span><br><span class="line">190 </span><br><span class="line">191         <span class="tag">&lt;<span class="name">size</span> <span class="attr">value</span>=<span class="string">&quot;50&quot;</span> /&gt;</span></span><br><span class="line">192 </span><br><span class="line">193         <span class="tag">&lt;<span class="name">layout</span> <span class="attr">type</span>=<span class="string">&quot;TGLog.ExpandLayout2.ReflectionLayout,TGLog&quot;</span>&gt;</span></span><br><span class="line">194 </span><br><span class="line">195           <span class="tag">&lt;<span class="name">conversionPattern</span> <span class="attr">value</span>=<span class="string">&quot;%property&#123;Browser&#125;&quot;</span> /&gt;</span></span><br><span class="line">196 </span><br><span class="line">197         <span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">198 </span><br><span class="line">199       <span class="tag">&lt;/<span class="name">parameter</span>&gt;</span></span><br><span class="line">200 </span><br><span class="line">201      </span><br><span class="line">202 </span><br><span class="line">203       <span class="tag">&lt;<span class="name">!—日志消息--</span>&gt;</span></span><br><span class="line">204 </span><br><span class="line">205       <span class="tag">&lt;<span class="name">parameter</span>&gt;</span></span><br><span class="line">206 </span><br><span class="line">207         <span class="tag">&lt;<span class="name">parameterName</span> <span class="attr">value</span>=<span class="string">&quot;@message&quot;</span> /&gt;</span></span><br><span class="line">208 </span><br><span class="line">209         <span class="tag">&lt;<span class="name">dbType</span> <span class="attr">value</span>=<span class="string">&quot;String&quot;</span> /&gt;</span></span><br><span class="line">210 </span><br><span class="line">211         <span class="tag">&lt;<span class="name">size</span> <span class="attr">value</span>=<span class="string">&quot;3000&quot;</span> /&gt;</span></span><br><span class="line">212 </span><br><span class="line">213         <span class="tag">&lt;<span class="name">layout</span> <span class="attr">type</span>=<span class="string">&quot;TGLog.ExpandLayout2.ReflectionLayout,TGLog&quot;</span>&gt;</span></span><br><span class="line">214 </span><br><span class="line">215           <span class="tag">&lt;<span class="name">conversionPattern</span> <span class="attr">value</span>=<span class="string">&quot;%property&#123;Message&#125;&quot;</span> /&gt;</span></span><br><span class="line">216 </span><br><span class="line">217         <span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">218 </span><br><span class="line">219       <span class="tag">&lt;/<span class="name">parameter</span>&gt;</span></span><br><span class="line">220 </span><br><span class="line">221  </span><br><span class="line">222 </span><br><span class="line">223       <span class="comment">&lt;!--动作类型--&gt;</span></span><br><span class="line">224 </span><br><span class="line">225       <span class="tag">&lt;<span class="name">parameter</span>&gt;</span></span><br><span class="line">226 </span><br><span class="line">227         <span class="tag">&lt;<span class="name">parameterName</span> <span class="attr">value</span>=<span class="string">&quot;@action_type&quot;</span> /&gt;</span></span><br><span class="line">228 </span><br><span class="line">229         <span class="tag">&lt;<span class="name">dbType</span> <span class="attr">value</span>=<span class="string">&quot;Int16&quot;</span> /&gt;</span></span><br><span class="line">230 </span><br><span class="line">231         <span class="tag">&lt;<span class="name">layout</span> <span class="attr">type</span>=<span class="string">&quot;TGLog.ExpandLayout2.ReflectionLayout,TGLog&quot;</span>&gt;</span></span><br><span class="line">232 </span><br><span class="line">233           <span class="tag">&lt;<span class="name">conversionPattern</span> <span class="attr">value</span>=<span class="string">&quot;%property&#123;ActionType&#125;&quot;</span> /&gt;</span></span><br><span class="line">234 </span><br><span class="line">235         <span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">236 </span><br><span class="line">237       <span class="tag">&lt;/<span class="name">parameter</span>&gt;</span></span><br><span class="line">238 </span><br><span class="line">239  </span><br><span class="line">240 </span><br><span class="line">241       <span class="tag">&lt;<span class="name">!—记录日志的位置--</span>&gt;</span></span><br><span class="line">242 </span><br><span class="line">243       <span class="tag">&lt;<span class="name">parameter</span>&gt;</span></span><br><span class="line">244 </span><br><span class="line">245         <span class="tag">&lt;<span class="name">parameterName</span> <span class="attr">value</span>=<span class="string">&quot;@location&quot;</span> /&gt;</span></span><br><span class="line">246 </span><br><span class="line">247         <span class="tag">&lt;<span class="name">dbType</span> <span class="attr">value</span>=<span class="string">&quot;String&quot;</span> /&gt;</span></span><br><span class="line">248 </span><br><span class="line">249         <span class="tag">&lt;<span class="name">size</span> <span class="attr">value</span>=<span class="string">&quot;2000&quot;</span> /&gt;</span></span><br><span class="line">250 </span><br><span class="line">251         <span class="tag">&lt;<span class="name">layout</span> <span class="attr">type</span>=<span class="string">&quot;log4net.Layout.PatternLayout&quot;</span>&gt;</span></span><br><span class="line">252 </span><br><span class="line">253           <span class="tag">&lt;<span class="name">conversionPattern</span> <span class="attr">value</span>=<span class="string">&quot;%location&quot;</span> /&gt;</span></span><br><span class="line">254 </span><br><span class="line">255         <span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">256 </span><br><span class="line">257       <span class="tag">&lt;/<span class="name">parameter</span>&gt;</span></span><br><span class="line">258 </span><br><span class="line">259      </span><br><span class="line">260 </span><br><span class="line">261       <span class="tag">&lt;<span class="name">!—异常信息。ExceptionLayout</span> 为异常输出的默认格式<span class="attr">--</span>&gt;</span></span><br><span class="line">262 </span><br><span class="line">263       <span class="tag">&lt;<span class="name">parameter</span>&gt;</span></span><br><span class="line">264 </span><br><span class="line">265         <span class="tag">&lt;<span class="name">parameterName</span> <span class="attr">value</span>=<span class="string">&quot;@exception&quot;</span> /&gt;</span></span><br><span class="line">266 </span><br><span class="line">267         <span class="tag">&lt;<span class="name">dbType</span> <span class="attr">value</span>=<span class="string">&quot;String&quot;</span> /&gt;</span></span><br><span class="line">268 </span><br><span class="line">269         <span class="tag">&lt;<span class="name">size</span> <span class="attr">value</span>=<span class="string">&quot;4000&quot;</span> /&gt;</span></span><br><span class="line">270 </span><br><span class="line">271         <span class="tag">&lt;<span class="name">layout</span> <span class="attr">type</span>=<span class="string">&quot;log4net.Layout.ExceptionLayout&quot;</span> /&gt;</span></span><br><span class="line">272 </span><br><span class="line">273       <span class="tag">&lt;/<span class="name">parameter</span>&gt;</span></span><br><span class="line">274 </span><br><span class="line">275 <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>注意：</p>
<p>向表中输出的字段不能多于数据表本身字段，而反之则可以，但这些多余字段一定使其可以为空，否则便写不到数据库；</p>
<p>输出字段的类型一定是对应数据表字段数据类型可以隐式转换的，而且长度也不能超过，否则也不能写入；</p>
<p>数据表字段设置尽量可以为空，这样可以避免一条日志记录存在空数据导致后面的日志都记录不了。</p>
<h2 id="4-3的配置"><a href="#4-3的配置" class="headerlink" title="4.3的配置"></a>4.3<logger>的配置</h2><p>在配置文件<appender>中的配置好了输出的介质，格式，过滤方式，还要定义日志对象<logger>。</p>
<p>在框架的体系里，所有的日志对象都是根日志(root logger)的后代。 因此如果一个日志对象没有在配置文件里显式定义，则框架使用根日志中定义的属性。在<root>标签里，可以定义level级别值和Appender的列表。如果没有定义LEVEL的值，则缺省为DEBUG。可以通过<appender-ref>标签定义日志对象使用的Appender对象。<appender-ref>声明了在其他地方定义的Appender对象的一个引用。在一个logger对象中的设置会覆盖根日志的设置。而对Appender属性来说，子日志对象则会继承父日志对象的Appender列表。这种缺省的行为方式也可以通过显式地设定<logger>标签的additivity属性为false而改变。</p>
<p><root>不显式申明时使用默认的配置。我觉得在使用时不定义<root>,自定义多个<logger>,在程序中记录日志时直接使用<logger>的name来查找相应的<logger>，这样更灵活一些。例如：</p>
<!--同时写两个文件和数据库-->



<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> 1 <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;ReflectionLayout&quot;</span>&gt;</span></span><br><span class="line"> 2 </span><br><span class="line"> 3       <span class="tag">&lt;<span class="name">level</span> <span class="attr">value</span>=<span class="string">&quot;DEBUG&quot;</span>/&gt;</span></span><br><span class="line"> 4 </span><br><span class="line"> 5       <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;HashtableLayout&quot;</span>/&gt;</span></span><br><span class="line"> 6 </span><br><span class="line"> 7       <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;ReflectionLayout&quot;</span>/&gt;</span></span><br><span class="line"> 8 </span><br><span class="line"> 9       <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;ADONetAppender&quot;</span>/&gt;</span></span><br><span class="line">10 </span><br><span class="line">11 <span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="4-4关联配置文件"><a href="#4-4关联配置文件" class="headerlink" title="4.4关联配置文件"></a>4.4关联配置文件</h2><p>log4net默认关联的是应用程序的配置文件App.config(BS程序是Web.config)，可以使用程序集自定义属性来进行设置。下面来介绍一下这个自定义属性：</p>
<p>log4net.Config.XmlConifguratorAttribute。 </p>
<p>XmlConfiguratorAttribute有3个属性：</p>
<p>ConfigFile： 配置文件的名字，文件路径相对于应用程序目录</p>
<p>(AppDomain.CurrentDomain.BaseDirectory)。ConfigFile属性不能和ConfigFileExtension属性一起使用。</p>
<p>ConfigFileExtension： 配置文件的扩展名，文件路径相对于应用程序的目录。ConfigFileExtension属性不能和ConfigFile属性一起使用。</p>
<p>Watch： 如果将Watch属性设置为true，就会监视配置文件。当配置文件发生变化的时候，就会重新加载。</p>
<p>如果ConfigFile和ConfigFileExtension都没有设置，则使用应用程序的配置文件App.config（Web.config）。</p>
<p>可以在项目的AssemblyInfo.cs文件里添加以下的语句：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"> 1  &#x2F;&#x2F;监视默认的配置文件，App.exe.config   </span><br><span class="line"> 2 </span><br><span class="line"> 3 [assembly: log4net.Config.XmlConfigurator(Watch &#x3D; true)]</span><br><span class="line"> 4 </span><br><span class="line"> 5  </span><br><span class="line"> 6 </span><br><span class="line"> 7 &#x2F;&#x2F;监视配置文件，App.exe.log4net。</span><br><span class="line"> 8 </span><br><span class="line"> 9 [assembly: log4net. Config.XmlConfigurator(ConfigFileExtension &#x3D; &quot;log4net&quot;, Watch &#x3D; true)]</span><br><span class="line">10 </span><br><span class="line">11  </span><br><span class="line">12 </span><br><span class="line">13 &#x2F;&#x2F;使用配置文件log4net.config，不监视改变。注意log4net.config文件的目录，BS程序在站点目录&#x2F;&#x2F;下，CS则在应用程序启动目录下，如调试时在&#x2F;bin&#x2F;Debug下，一般将文件属性的文件输出目录调为&#x2F;&#x2F;始终复制即可</span><br><span class="line">14 </span><br><span class="line">15 [assembly: log4net. Config.XmlConfigurator(ConfigFile &#x3D; &quot;log4net.config&quot;)]</span><br><span class="line">16 </span><br><span class="line">17  </span><br><span class="line">18 </span><br><span class="line">19 &#x2F;&#x2F;使用配置文件log4net.config，不监视改变</span><br><span class="line">20 </span><br><span class="line">21 [assembly: log4net. Config.XmlConfigurator()]</span><br></pre></td></tr></table></figure>



<p>也可以在Global.asax的Application_Start里或者是Program.cs中的Main方法中添加，注意这里一定是绝对路径，如下所示：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1</span> <span class="comment">//这是在BS程序下，使用自定义的配置文件log4net.xml，使用Server.MapPath(&quot;~&quot;) + //@&quot;/log4net.xml”来取得路径。/log4net.xml为相对于站点的路径</span></span><br><span class="line"> <span class="number">2</span> </span><br><span class="line"> <span class="number">3</span> <span class="comment">// ConfigureAndWatch()相当于Configure(Watch = true)</span></span><br><span class="line"> <span class="number">4</span> </span><br><span class="line"> <span class="number">5</span> log4net.Config.XmlConfigurator.ConfigureAndWatch(</span><br><span class="line"> <span class="number">6</span> </span><br><span class="line"> <span class="number">7</span> <span class="keyword">new</span> System.IO.FileInfo(Server.MapPath(<span class="string">&quot;~&quot;</span>) + <span class="string">@&quot;/log4net.xml&quot;</span>));</span><br><span class="line"> <span class="number">8</span> </span><br><span class="line"> <span class="number">9</span> <span class="comment">//这是在CS程序下，可以用以下方法获得：</span></span><br><span class="line"><span class="number">10</span> </span><br><span class="line"><span class="number">11</span> <span class="keyword">string</span> assemblyFilePath = Assembly.GetExecutingAssembly().Location;</span><br><span class="line"><span class="number">12</span> </span><br><span class="line"><span class="number">13</span> <span class="keyword">string</span> assemblyDirPath = Path.GetDirectoryName(assemblyFilePath);</span><br><span class="line"><span class="number">14</span> </span><br><span class="line"><span class="number">15</span> <span class="keyword">string</span> configFilePath = assemblyDirPath + <span class="string">&quot; //log4net.xml&quot;</span>;</span><br><span class="line"><span class="number">16</span> </span><br><span class="line"><span class="number">17</span> log4net.Config.XmlConfigurator.ConfigureAndWatch(</span><br><span class="line"><span class="number">18</span> </span><br><span class="line"><span class="number">19</span> <span class="keyword">new</span> FileInfo(configFilePath));</span><br></pre></td></tr></table></figure>



<p>或直接使用绝对路径：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1 &#x2F;&#x2F;使用自定义的配置文件，直接绝对路径为：c:&#x2F;log4net.config</span><br><span class="line">2 </span><br><span class="line">3 log4net.Config.XmlConfigurator.Configure(new System.IO.FileInfo(@&quot;c:&#x2F;log4net.config&quot;));</span><br></pre></td></tr></table></figure>

<h1 id="5、如何记录日志"><a href="#5、如何记录日志" class="headerlink" title="5、如何记录日志"></a>5、如何记录日志</h1><p>Log4net使用很方便，先申明一个封装类ILog 的对象，如下：</p>
<p>log4net.ILog log = log4net.LogManager.GetLogger(“ReflectionLayout”);</p>
<p>其中”ReflectionLayout”便是我们自定义的日志对象<logger>的name的值。</p>
<p>对应5个日志输出级别，log有5 个方法，每个方法都有两个重载，使用如下：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1</span>         <span class="keyword">try</span></span><br><span class="line"> <span class="number">2</span> </span><br><span class="line"> <span class="number">3</span>             &#123;</span><br><span class="line"> <span class="number">4</span> </span><br><span class="line"> <span class="number">5</span>                 log.Debug(<span class="string">&quot;这是一个测试！&quot;</span>);</span><br><span class="line"> <span class="number">6</span> </span><br><span class="line"> <span class="number">7</span>             &#125;</span><br><span class="line"> <span class="number">8</span> </span><br><span class="line"> <span class="number">9</span>             <span class="keyword">catch</span>(Exception ec)</span><br><span class="line"><span class="number">10</span> </span><br><span class="line"><span class="number">11</span>             &#123;</span><br><span class="line"><span class="number">12</span> </span><br><span class="line"><span class="number">13</span>                 log.Error(<span class="string">&quot;出现错误！&quot;</span>, ec);</span><br><span class="line"><span class="number">14</span> </span><br><span class="line"><span class="number">15</span>          &#125;</span><br></pre></td></tr></table></figure>



<p>如果我们需要输出的消息是要区别开来，不按一个字符串全部输出，就需要进行一些扩展了。</p>
<h1 id="6、Log4net的简单扩展"><a href="#6、Log4net的简单扩展" class="headerlink" title="6、Log4net的简单扩展"></a>6、Log4net的简单扩展</h1><h2 id="6-1通过重写布局Layout输出传入的-message对象的属性"><a href="#6-1通过重写布局Layout输出传入的-message对象的属性" class="headerlink" title="6.1通过重写布局Layout输出传入的 message对象的属性"></a>6.1通过重写布局Layout输出传入的 message对象的属性</h2><h3 id="6-1-1重写Layout类"><a href="#6-1-1重写Layout类" class="headerlink" title="6.1.1重写Layout类"></a>6.1.1重写Layout类</h3><p>通过继承log4net.Layout.<strong>PatternLayout</strong>类，使用log4net.Core.LoggingEvent类的方法得到了要输出的message类的名称，然后通过反射得到各个属性的值，使用<strong>PatternLayout</strong>类AddConverter方法传入得到的值。这里注意要引用用到的类的命名空间。</p>
<p>代码见附注8.2。</p>
<h3 id="6-1-2配置相应的配置文件"><a href="#6-1-2配置相应的配置文件" class="headerlink" title="6.1.2配置相应的配置文件"></a>6.1.2配置相应的配置文件</h3><p>配置文件其他地方不用改动，只是需要改动<appender>中的<layout>。例如：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1 <span class="tag">&lt;<span class="name">layout</span> <span class="attr">type</span>=<span class="string">&quot;TGLog.ExpandLayout2.ReflectionLayout,TGLog&quot;</span>&gt;</span></span><br><span class="line">2 </span><br><span class="line">3         <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;ConversionPattern&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">4</span> </span></span><br><span class="line"><span class="tag"><span class="attr">5</span>  <span class="attr">value</span>=<span class="string">&quot;记录时间：%date    操作者ID：%property&#123;Operator&#125;             </span></span></span><br><span class="line"><span class="tag"><span class="string">6 </span></span></span><br><span class="line"><span class="tag"><span class="string">7 操作类型：%property&#123;Action&#125;%n  消息描述：%property&#123;Message&#125;%n                    异常：%exception%n &quot;</span> /&gt;</span></span><br><span class="line">8 </span><br><span class="line">9       <span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>其中<layout>的type由原来的log4net.Layout.<strong>PatternLayout</strong>换为自定义的TGLog.ExpandLayout2.ReflectionLayout（TGLog.ExpandLayout2为命名空间）。%property{Operator}输出的即为message类对象的属性Operator的值。数据库配置同样，相应的字段如果是自定义的，则输出选用自定义的<layout>。例：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> 1 <span class="comment">&lt;!--动作类型--&gt;</span></span><br><span class="line"> 2 </span><br><span class="line"> 3   <span class="tag">&lt;<span class="name">parameter</span>&gt;</span></span><br><span class="line"> 4 </span><br><span class="line"> 5       <span class="tag">&lt;<span class="name">parameterName</span> <span class="attr">value</span>=<span class="string">&quot;@action_type&quot;</span> /&gt;</span></span><br><span class="line"> 6 </span><br><span class="line"> 7       <span class="tag">&lt;<span class="name">dbType</span> <span class="attr">value</span>=<span class="string">&quot;Int16&quot;</span> /&gt;</span></span><br><span class="line"> 8 </span><br><span class="line"> 9       <span class="tag">&lt;<span class="name">layout</span> <span class="attr">type</span>=<span class="string">&quot;TGLog.ExpandLayout2.ReflectionLayout,TGLog&quot;</span>&gt;</span></span><br><span class="line">10 </span><br><span class="line">11          <span class="tag">&lt;<span class="name">conversionPattern</span> <span class="attr">value</span>=<span class="string">&quot;%property&#123;ActionType&#125;&quot;</span> /&gt;</span></span><br><span class="line">12 </span><br><span class="line">13       <span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">14 </span><br><span class="line">15   <span class="tag">&lt;/<span class="name">parameter</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="6-1-3程序中如何使用"><a href="#6-1-3程序中如何使用" class="headerlink" title="6.1.3程序中如何使用"></a>6.1.3程序中如何使用</h3><p>和一般使用方法基本相同，只是传入的参数是一个自定义的类，类的属性和配置文件中<layout>所有的%property{属性}是一致的，即%property{属性}在输出的时候就查找传入message类中有无对应的属性，如果有就输出值，没有则输出null。例：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1</span> log4net.ILog log = log4net.LogManager.GetLogger(<span class="string">&quot;ReflectionLayout&quot;</span>);</span><br><span class="line"> <span class="number">2</span> </span><br><span class="line"> <span class="number">3</span> <span class="keyword">try</span></span><br><span class="line"> <span class="number">4</span> </span><br><span class="line"> <span class="number">5</span>             &#123;</span><br><span class="line"> <span class="number">6</span> </span><br><span class="line"> <span class="number">7</span>                 log.Debug(<span class="keyword">new</span> LogMessage(</span><br><span class="line"> <span class="number">8</span> </span><br><span class="line"> <span class="number">9</span> <span class="number">1</span>,</span><br><span class="line"><span class="number">10</span> </span><br><span class="line"><span class="number">11</span> <span class="string">&quot;操作对象：0&quot;</span>,</span><br><span class="line"><span class="number">12</span> </span><br><span class="line"><span class="number">13</span>  (<span class="keyword">int</span>)TGLog.ActionType.Other,</span><br><span class="line"><span class="number">14</span> </span><br><span class="line"><span class="number">15</span>  <span class="string">&quot;这是四个参数测试&quot;</span>)</span><br><span class="line"><span class="number">16</span> </span><br><span class="line"><span class="number">17</span> );</span><br><span class="line"><span class="number">18</span> </span><br><span class="line"><span class="number">19</span>             &#125;</span><br><span class="line"><span class="number">20</span> </span><br><span class="line"><span class="number">21</span>             <span class="keyword">catch</span>(Exception ec)</span><br><span class="line"><span class="number">22</span> </span><br><span class="line"><span class="number">23</span>             &#123;</span><br><span class="line"><span class="number">24</span> </span><br><span class="line"><span class="number">25</span>                 log.Error(<span class="keyword">new</span> LogMessage(</span><br><span class="line"><span class="number">26</span> </span><br><span class="line"><span class="number">27</span>                                     <span class="number">1</span>,</span><br><span class="line"><span class="number">28</span> </span><br><span class="line"><span class="number">29</span>                                     <span class="string">&quot;操作对象：0&quot;</span>,</span><br><span class="line"><span class="number">30</span> </span><br><span class="line"><span class="number">31</span>                                     (<span class="keyword">int</span>)TGLog.ActionType.Other,</span><br><span class="line"><span class="number">32</span> </span><br><span class="line"><span class="number">33</span>                                     <span class="string">&quot;这是全部参数测试&quot;</span>,</span><br><span class="line"><span class="number">34</span> </span><br><span class="line"><span class="number">35</span>                                     <span class="string">&quot;192.168.1.1&quot;</span>,</span><br><span class="line"><span class="number">36</span> </span><br><span class="line"><span class="number">37</span>                                     <span class="string">&quot;MyComputer&quot;</span>,</span><br><span class="line"><span class="number">38</span> </span><br><span class="line"><span class="number">39</span>                                     <span class="string">&quot;Maxthon(MyIE2)Fans&quot;</span>),</span><br><span class="line"><span class="number">40</span> </span><br><span class="line"><span class="number">41</span>                          ec</span><br><span class="line"><span class="number">42</span> </span><br><span class="line"><span class="number">43</span> );</span><br><span class="line"><span class="number">44</span> </span><br><span class="line"><span class="number">45</span>       &#125;</span><br></pre></td></tr></table></figure>



<p>LogMessage的全部属性的构造方法如下：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1</span> <span class="function"><span class="keyword">public</span> <span class="title">LogMessage</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params"> <span class="number">2</span> </span></span></span><br><span class="line"><span class="function"><span class="params"> <span class="number">3</span>             <span class="keyword">int</span> operatorID,</span></span></span><br><span class="line"><span class="function"><span class="params"> <span class="number">4</span> </span></span></span><br><span class="line"><span class="function"><span class="params"> <span class="number">5</span>             <span class="keyword">string</span> operand,</span></span></span><br><span class="line"><span class="function"><span class="params"> <span class="number">6</span> </span></span></span><br><span class="line"><span class="function"><span class="params"> <span class="number">7</span>             <span class="keyword">int</span> ActionType,</span></span></span><br><span class="line"><span class="function"><span class="params"> <span class="number">8</span> </span></span></span><br><span class="line"><span class="function"><span class="params"> <span class="number">9</span>             <span class="keyword">string</span> message,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">10</span> </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">11</span>             <span class="keyword">string</span> ip,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">12</span> </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">13</span>             <span class="keyword">string</span> machineName,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">14</span> </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">15</span>             <span class="keyword">string</span> browser</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">16</span> </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">17</span>             </span>)</span></span><br><span class="line"><span class="function">18 </span></span><br><span class="line"><span class="function">19</span>      &#123;</span><br><span class="line"><span class="number">20</span> </span><br><span class="line"><span class="number">21</span>             <span class="keyword">this</span>.ActionType = ActionType;</span><br><span class="line"><span class="number">22</span> </span><br><span class="line"><span class="number">23</span>             <span class="keyword">this</span>.Operator = operatorID;</span><br><span class="line"><span class="number">24</span> </span><br><span class="line"><span class="number">25</span>             <span class="keyword">this</span>.Message = message;</span><br><span class="line"><span class="number">26</span> </span><br><span class="line"><span class="number">27</span>             <span class="keyword">this</span>.Operand = operand;</span><br><span class="line"><span class="number">28</span> </span><br><span class="line"><span class="number">29</span>             <span class="keyword">this</span>.IP = ip;</span><br><span class="line"><span class="number">30</span> </span><br><span class="line"><span class="number">31</span>             <span class="keyword">this</span>.Browser = browser;</span><br><span class="line"><span class="number">32</span> </span><br><span class="line"><span class="number">33</span>             <span class="keyword">this</span>.MachineName = machineName;</span><br><span class="line"><span class="number">34</span> </span><br><span class="line"><span class="number">35</span> &#125;</span><br></pre></td></tr></table></figure>



<h2 id="6-2通过重新实现ILog接口来增加输入的参数"><a href="#6-2通过重新实现ILog接口来增加输入的参数" class="headerlink" title="6.2通过重新实现ILog接口来增加输入的参数"></a>6.2通过重新实现ILog接口来增加输入的参数</h2><h3 id="6-2-1重写LogImpl，LogManager类及实现ILog接口"><a href="#6-2-1重写LogImpl，LogManager类及实现ILog接口" class="headerlink" title="6.2.1重写LogImpl，LogManager类及实现ILog接口"></a>6.2.1重写LogImpl，LogManager类及实现ILog接口</h3><p>这种方式是通过构造一个名为<strong>IMyLog</strong>接口，是继承<strong>Ilog</strong>接口而来，然后分别在<strong>MyLogImpl**</strong>，MyLogManager<strong>重新实现</strong>IMyLog<strong>接口，增加了每种方法的参数。</strong>MyLogImpl**<strong>，MyLogManager</strong>分别继承<strong>LogImpl**</strong>，LogManager**而来。</p>
<p>代码分别见8.3、8.4、8.5：</p>
<h3 id="6-2-2配置相应的配置文件"><a href="#6-2-2配置相应的配置文件" class="headerlink" title="6.2.2配置相应的配置文件"></a>6.2.2配置相应的配置文件</h3><p>配置文件其他地方不用改动，只是需要改动<appender>中的<layout>元素name为ConversionPattern的value中输出格式。例如：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> &lt;layout type=<span class="string">&quot; log4net.Layout.PatternLayout &quot;</span>&gt;</span><br><span class="line"><span class="number">2</span> </span><br><span class="line"><span class="number">3</span>         &lt;param name=<span class="string">&quot;ConversionPattern&quot;</span></span><br><span class="line"><span class="number">4</span> </span><br><span class="line"><span class="number">5</span>  <span class="keyword">value</span>=<span class="string">&quot;记录时间：%date    操作者ID：%property&#123;Operator&#125;             </span></span><br><span class="line"><span class="string">6 </span></span><br><span class="line"><span class="string">7 操作类型：%property&#123;Action&#125;%n  消息描述：%property&#123;Message&#125;%n                    异常：%exception%n &quot;</span> /&gt;</span><br><span class="line"><span class="number">8</span> </span><br><span class="line"><span class="number">9</span>       &lt;/layout&gt;</span><br></pre></td></tr></table></figure>



<p>%property{参数}中的参数在<strong>MyLogImpl</strong>类中定义，如语句：</p>
<p>loggingEvent.Properties[“Operator”] = operatorID;</p>
<p>就定义了Operator输出参数，即%property{Operator}输出的即为<strong>IMyLog</strong>中的参数operatorID的值。</p>
<p>数据库配置同样。例：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1</span> &lt;!--动作类型--&gt;</span><br><span class="line"> <span class="number">2</span> </span><br><span class="line"> <span class="number">3</span>   &lt;parameter&gt;</span><br><span class="line"> <span class="number">4</span> </span><br><span class="line"> <span class="number">5</span>       &lt;parameterName <span class="keyword">value</span>=<span class="string">&quot;@action_type&quot;</span> /&gt;</span><br><span class="line"> <span class="number">6</span> </span><br><span class="line"> <span class="number">7</span>       &lt;dbType <span class="keyword">value</span>=<span class="string">&quot;Int16&quot;</span> /&gt;</span><br><span class="line"> <span class="number">8</span> </span><br><span class="line"> <span class="number">9</span>       &lt;layout type=<span class="string">&quot; log4net.Layout.PatternLayout &quot;</span>&gt;</span><br><span class="line"><span class="number">10</span> </span><br><span class="line"><span class="number">11</span>          &lt;conversionPattern <span class="keyword">value</span>=<span class="string">&quot;%property&#123;ActionType&#125;&quot;</span> /&gt;</span><br><span class="line"><span class="number">12</span> </span><br><span class="line"><span class="number">13</span>       &lt;/layout&gt;</span><br><span class="line"><span class="number">14</span> </span><br><span class="line"><span class="number">15</span>   &lt;/parameter&gt;</span><br></pre></td></tr></table></figure>



<h3 id="6-2-3程序中如何使用"><a href="#6-2-3程序中如何使用" class="headerlink" title="6.2.3程序中如何使用"></a>6.2.3程序中如何使用</h3><p>先引用IMyLog ，MyLogManager所在的命名空间，创建一个IMyLog对象，myLog的5 个方法，每个方法都有四个重载，增加了多参数的重载。例：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1</span> IMyLog myLog = MyLogManager.GetLogger(<span class="string">&quot;ExpandILog&quot;</span>);</span><br><span class="line"> <span class="number">2</span> </span><br><span class="line"> <span class="number">3</span> <span class="keyword">try</span></span><br><span class="line"> <span class="number">4</span> </span><br><span class="line"> <span class="number">5</span>             &#123;</span><br><span class="line"> <span class="number">6</span> </span><br><span class="line"> <span class="number">7</span> myLog.Debug(<span class="string">&quot;这是一个参数重载测试!&quot;</span>);          </span><br><span class="line"> <span class="number">8</span> </span><br><span class="line"> <span class="number">9</span> &#125;</span><br><span class="line"><span class="number">10</span> </span><br><span class="line"><span class="number">11</span>             <span class="keyword">catch</span>(Exception ec)</span><br><span class="line"><span class="number">12</span> </span><br><span class="line"><span class="number">13</span>             &#123;</span><br><span class="line"><span class="number">14</span> </span><br><span class="line"><span class="number">15</span>                 log.Error(</span><br><span class="line"><span class="number">16</span> </span><br><span class="line"><span class="number">17</span>                           <span class="number">1</span>,</span><br><span class="line"><span class="number">18</span> </span><br><span class="line"><span class="number">19</span>                           <span class="string">&quot;操作对象：0&quot;</span>,</span><br><span class="line"><span class="number">20</span> </span><br><span class="line"><span class="number">21</span>                           (<span class="keyword">int</span>)TGLog.ActionType.Other,</span><br><span class="line"><span class="number">22</span> </span><br><span class="line"><span class="number">23</span>                           <span class="string">&quot;这是全部参数测试&quot;</span>,</span><br><span class="line"><span class="number">24</span> </span><br><span class="line"><span class="number">25</span>                           <span class="string">&quot;192.168.1.1&quot;</span>,</span><br><span class="line"><span class="number">26</span> </span><br><span class="line"><span class="number">27</span>                           <span class="string">&quot;MyComputer&quot;</span>,</span><br><span class="line"><span class="number">28</span> </span><br><span class="line"><span class="number">29</span>                           <span class="string">&quot;Maxthon(MyIE2)Fans&quot;</span>,</span><br><span class="line"><span class="number">30</span> </span><br><span class="line"><span class="number">31</span>                           ec</span><br><span class="line"><span class="number">32</span> </span><br><span class="line"><span class="number">33</span> );</span><br><span class="line"><span class="number">34</span> </span><br><span class="line"><span class="number">35</span>       &#125;</span><br></pre></td></tr></table></figure>



<h1 id="7、总结"><a href="#7、总结" class="headerlink" title="7、总结"></a>7、总结</h1><p>Log4net 功能很多，这里只是对已经尝试用过的功能总结一下，普通写日志已经足够。需要注意的是：</p>
<p>\1.      Log4net本身也有一些缺陷，比如一个记录引起了log4net本身的异常，就会使后面的日志无法记录下来，尤其是在写入数据库时。例如使用6.1扩展后，int型的属性在<appender >的元素<bufferSize>设置不为1时，<dbType value="Int32" />时，就不能输出到数据库，而<dbType value="Int16" />则没任何问题。</p>
<p>\2.      Log4net本身出现了异常，比如配置文件出现错误，有些日志输出方式会记录下这些异常，例如应用程序控制台；有些则不会输出这些错误，如数据库与文件。</p>
<p>\3.      扩展时也会留下一些问题。例如在使用6.1扩展输出字段时就会出现，在log.debug(object message)中，如果message是一个自定义的类，属性与配置文件中输出设置也一致，构造函数时也只构造一个参数的实例，写文件与写数据库都成功，而将message按没有扩展的方式直接传入一个字符串，即log.debug(“信息内容”)使用则只能写入文件，而数据库则没写入。自定义的Layout 就是继承默认的<strong>PatternLayout</strong>，本来不应该出错，但出现了问题。原因分析是自定义的message类有类型为int的属性，作为一个对象传入时在默认值0，而直接使用字符串则int型的字段得不到默认值，引发异常。所以建议在有扩展存在时，最好多设几个<logger>,区分清楚，按照统一的形式记录日志，不要混合使用。</p>
<p>\4.      配置文件的设置一定要准确，在一点不正确就会导致日志不能正常输出，所以在配置时先从最简单的开始，同时输出方式选择一种能输出log4net本身异常的方式，成功后一点一点加在新配置，这样出错了也容易找到那个地方配置有问题。</p>
<p>\5.      log4net扩展性很强，几乎所有的组件都可以重写，在配置文件中配置好就可以使用。</p>
<h1 id="8、附注："><a href="#8、附注：" class="headerlink" title="8、附注："></a>8、附注：</h1><h3 id="8-1PatterLayout格式化字符表"><a href="#8-1PatterLayout格式化字符表" class="headerlink" title="8.1PatterLayout格式化字符表"></a>8.1PatterLayout格式化字符表</h3><table>
<thead>
<tr>
<th><strong>转换字符</strong></th>
<th><strong>效果</strong></th>
</tr>
</thead>
<tbody><tr>
<td>a</td>
<td>等价于appdomain</td>
</tr>
<tr>
<td>appdomain</td>
<td>引发日志事件的应用程序域的友好名称。（使用中一般是可执行文件的名字。）</td>
</tr>
<tr>
<td>c</td>
<td>等价于 logger</td>
</tr>
<tr>
<td>C</td>
<td>等价于 type</td>
</tr>
<tr>
<td>class</td>
<td>等价于 type</td>
</tr>
<tr>
<td>d</td>
<td>等价于 date</td>
</tr>
<tr>
<td>date</td>
<td>发生日志事件的本地时间。 使用 DE&gt;%utcdate 输出UTC时间。date后面还可以跟一个日期格式，用大括号括起来。DE&gt;例如：%date{HH:mm:ss,fff}或者%date{dd MMM yyyy HH:mm:ss,fff}。如果date后面什么也不跟，将使用ISO8601 格式 。日期格式和.Net中DateTime类的ToString方法中使用的格式是一样。另外log4net还有3个自己的格式Formatter。 它们是 “ABSOLUTE”, “DATE”和”ISO8601”分别代表 AbsoluteTimeDateFormatter, DateTimeDateFormatter和Iso8601DateFormatter。例如：%date{ISO8601}或%date{ABSOLUTE}。它们的性能要好于ToString。</td>
</tr>
<tr>
<td>exception</td>
<td>异常信息日志事件中必须存了一个异常对象，如果日志事件不包含没有异常对象，将什么也不输出。异常输出完毕后会跟一个换行。一般会在输出异常前加一个换行，并将异常放在最后。</td>
</tr>
<tr>
<td>F</td>
<td>等价于 file</td>
</tr>
<tr>
<td>file</td>
<td>发生日志请求的源代码文件的名字。警告：只在调试的时候有效。调用本地信息会影响性能。</td>
</tr>
<tr>
<td>identity</td>
<td>当前活动用户的名字(Principal.Identity.Name).警告：会影响性能。（我测试的时候%identity返回都是空的。）</td>
</tr>
<tr>
<td>l</td>
<td>等价于 location</td>
</tr>
<tr>
<td>L</td>
<td>等价于 line</td>
</tr>
<tr>
<td>location</td>
<td>引发日志事件的方法（包括命名空间和类名），以及所在的源文件和行号。警告：会影响性能。没有pdb文件的话，只有方法名，没有源文件名和行号。</td>
</tr>
<tr>
<td>level</td>
<td>日志事件等级</td>
</tr>
<tr>
<td>line</td>
<td>引发日志事件的行号警告：会影响性能。</td>
</tr>
<tr>
<td>logger</td>
<td>记录日志事件的Logger对象的名字。可以使用精度说明符控制Logger的名字的输出层级，默认输出全名。注意，精度符的控制是从右开始的。例如：logger 名为 “a.b.c”， 输出模型为%logger{2} ，将输出”b.c”。</td>
</tr>
<tr>
<td>m</td>
<td>等价于 message</td>
</tr>
<tr>
<td>M</td>
<td>等价于 method</td>
</tr>
<tr>
<td>message</td>
<td>由应用程序提供给日志事件的消息。</td>
</tr>
<tr>
<td>mdc</td>
<td>MDC (旧为：ThreadContext.Properties) 现在是事件属性的一部分。 保留它是为了兼容性，它等价于 property。</td>
</tr>
<tr>
<td>method</td>
<td>发生日志请求的方法名（只有方法名而已）。警告：会影响性能。</td>
</tr>
<tr>
<td>n</td>
<td>等价于 newline</td>
</tr>
<tr>
<td>newline</td>
<td>换行符</td>
</tr>
<tr>
<td>ndc</td>
<td>NDC (nested diagnostic context)</td>
</tr>
<tr>
<td>p</td>
<td>等价于 level</td>
</tr>
<tr>
<td>P</td>
<td>等价于 property</td>
</tr>
<tr>
<td>properties</td>
<td>等价于 property</td>
</tr>
<tr>
<td>property</td>
<td>输出事件的特殊属性。例如： %property{user} 输出user属性。属性是由loggers或appenders添加到时间中的。 有一个默认的属性”DE&gt;log4net:HostName”总是会有。DE&gt;%property将输出所有的属性 。（扩展后可以使用）</td>
</tr>
<tr>
<td>r</td>
<td>等价于 timestamp</td>
</tr>
<tr>
<td>t</td>
<td>等价于 thread</td>
</tr>
<tr>
<td>timestamp</td>
<td>从程序启动到事件发生所经过的毫秒数。</td>
</tr>
<tr>
<td>thread</td>
<td>引发日志事件的线程，如果没有线程名就使用线程号。</td>
</tr>
<tr>
<td>type</td>
<td>引发日志请求的类的全名。.可以使用精度控制符。例如： 类名是 “log4net.Layout.<strong>PatternLayout</strong>“, 格式模型是%type{1} 将输出”<strong>PatternLayout</strong>“。（也是从右开始的。）警告：会影响性能。</td>
</tr>
<tr>
<td>u</td>
<td>等价于 identity</td>
</tr>
<tr>
<td>username</td>
<td>当前用户的WindowsIdentity。（类似：HostName/Username）警告：会影响性能。</td>
</tr>
<tr>
<td>utcdate</td>
<td>发生日志事件的UTC时间。DE&gt;后面还可以跟一个日期格式，用大括号括起来。DE&gt;例如：%utcdate{HH:mm:ss,fff}或者%utcdate{dd MMM yyyy HH:mm:ss,fff}。如果utcdate后面什么也不跟，将使用ISO8601 格式 。日期格式和.Net中DateTime类的ToString方法中使用的格式是一样。另外log4net还有3个自己的格式Formatter。 它们是 “ABSOLUTE”, “DATE”和”ISO8601”分别代表 AbsoluteTimeDateFormatter, DateTimeDateFormatter和Iso8601DateFormatter。例如：%date{ISO8601}或%date{ABSOLUTE}。它们的性能要好于ToString。</td>
</tr>
<tr>
<td>w</td>
<td>等价于 username</td>
</tr>
<tr>
<td>x</td>
<td>等价于 ndc</td>
</tr>
<tr>
<td>X</td>
<td>等价于 mdc</td>
</tr>
<tr>
<td>%</td>
<td>%%输出一个百分号</td>
</tr>
</tbody></table>
<p>关于调用本地信息（caller location information）的说明：</p>
<p>%type %file %line %method %location %class %C %F %L %l %M 都会调用本地信息。这样做会影响性能。本地信息使用System.Diagnostics.StackTrace得到。.Net 1.0 不支持System.Diagnostics.StackTrace 类。</p>
<p>本地信息在调试模式下可以正常获取，在非调试模式下可能获取不到，或只能获取一部分。（根据我的测试，其实是需要有一个程序数据库（.pdb）文件。）</p>
<p>%property属性要用代码来设置才能使用（也就是扩展一下），</p>
<p>默认属性log4net:HostName不用设置。</p>
<p>转义字符的修饰符：</p>
<table>
<thead>
<tr>
<th>Format modifier</th>
<th>left justify</th>
<th>minimum width</th>
<th>maximum width</th>
<th>comment</th>
</tr>
</thead>
<tbody><tr>
<td>%20logger</td>
<td>false</td>
<td>20</td>
<td>none</td>
<td>如果logger名不足20个字符，就在左边补空格。</td>
</tr>
<tr>
<td>%-20logger</td>
<td>true</td>
<td>20</td>
<td>none</td>
<td>如果logger名不足20个字符，就在右边补空格。</td>
</tr>
<tr>
<td>%.30logger</td>
<td>NA</td>
<td>none</td>
<td>30</td>
<td>超过30个字符将截断。</td>
</tr>
<tr>
<td>%20.30logger</td>
<td>false</td>
<td>20</td>
<td>30</td>
<td>logger名要在20到30之间，少了在左边补空格，多了截断。</td>
</tr>
<tr>
<td>%-20.30logger</td>
<td>true</td>
<td>20</td>
<td>30</td>
<td>logger名要在20到30之间，少了在右边补空格，多了截断。</td>
</tr>
</tbody></table>
<h3 id="8-2Layout类代码"><a href="#8-2Layout类代码" class="headerlink" title="8.2Layout类代码"></a>8.2Layout类代码</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line">  <span class="number">1</span> <span class="keyword">using</span> System;</span><br><span class="line">  <span class="number">2</span> </span><br><span class="line">  <span class="number">3</span> <span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line">  <span class="number">4</span> </span><br><span class="line">  <span class="number">5</span> <span class="keyword">using</span> System.Linq;</span><br><span class="line">  <span class="number">6</span> </span><br><span class="line">  <span class="number">7</span> <span class="keyword">using</span> System.Text;</span><br><span class="line">  <span class="number">8</span> </span><br><span class="line">  <span class="number">9</span> <span class="keyword">using</span> log4net.Layout;</span><br><span class="line"> <span class="number">10</span> </span><br><span class="line"> <span class="number">11</span> <span class="keyword">using</span> log4net.Layout.Pattern;</span><br><span class="line"> <span class="number">12</span> </span><br><span class="line"> <span class="number">13</span> <span class="keyword">using</span> System.Reflection;</span><br><span class="line"> <span class="number">14</span> </span><br><span class="line"> <span class="number">15</span> <span class="keyword">using</span> System.Collections;</span><br><span class="line"> <span class="number">16</span> </span><br><span class="line"> <span class="number">17</span> <span class="keyword">using</span> FastReflectionLib;</span><br><span class="line"> <span class="number">18</span> </span><br><span class="line"> <span class="number">19</span>  </span><br><span class="line"> <span class="number">20</span> </span><br><span class="line"> <span class="number">21</span> <span class="keyword">namespace</span> <span class="title">TGLog.ExpandLayout2</span></span><br><span class="line"> 22 </span><br><span class="line"> <span class="number">23</span> &#123;</span><br><span class="line"> <span class="number">24</span> </span><br><span class="line"> <span class="number">25</span>     <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ReflectionLayout</span> : <span class="title">PatternLayout</span></span><br><span class="line"> 26 </span><br><span class="line"> <span class="number">27</span>     &#123;</span><br><span class="line"> <span class="number">28</span> </span><br><span class="line"> <span class="number">29</span>         <span class="function"><span class="keyword">public</span> <span class="title">ReflectionLayout</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"> 30 </span></span><br><span class="line"><span class="function"> 31</span>         &#123;</span><br><span class="line"> <span class="number">32</span> </span><br><span class="line"> <span class="number">33</span>             <span class="keyword">this</span>.AddConverter(<span class="string">&quot;property&quot;</span>, <span class="keyword">typeof</span>(ReflectionPatternConverter));</span><br><span class="line"> <span class="number">34</span> </span><br><span class="line"> <span class="number">35</span>         &#125;</span><br><span class="line"> <span class="number">36</span> </span><br><span class="line"> <span class="number">37</span>     &#125;</span><br><span class="line"> <span class="number">38</span> </span><br><span class="line"> <span class="number">39</span>  </span><br><span class="line"> <span class="number">40</span> </span><br><span class="line"> <span class="number">41</span>     <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ReflectionPatternConverter</span> : <span class="title">PatternLayoutConverter</span></span><br><span class="line"> 42 </span><br><span class="line"> <span class="number">43</span>     &#123;</span><br><span class="line"> <span class="number">44</span> </span><br><span class="line"> <span class="number">45</span>         <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Convert</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params"> <span class="number">46</span> </span></span></span><br><span class="line"><span class="function"><span class="params"> <span class="number">47</span> System.IO.TextWriter writer,</span></span></span><br><span class="line"><span class="function"><span class="params"> <span class="number">48</span> </span></span></span><br><span class="line"><span class="function"><span class="params"> <span class="number">49</span>  log4net.Core.LoggingEvent loggingEvent</span></span></span><br><span class="line"><span class="function"><span class="params"> <span class="number">50</span> </span></span></span><br><span class="line"><span class="function"><span class="params"> <span class="number">51</span> </span>)</span></span><br><span class="line"><span class="function"> 52 </span></span><br><span class="line"><span class="function"> 53</span>         &#123;</span><br><span class="line"> <span class="number">54</span> </span><br><span class="line"> <span class="number">55</span>             <span class="keyword">if</span> (Option != <span class="literal">null</span>)</span><br><span class="line"> <span class="number">56</span> </span><br><span class="line"> <span class="number">57</span>             &#123;</span><br><span class="line"> <span class="number">58</span> </span><br><span class="line"> <span class="number">59</span>                 <span class="comment">// 写入指定键的值</span></span><br><span class="line"> <span class="number">60</span> </span><br><span class="line"> <span class="number">61</span>                 WriteObject(</span><br><span class="line"> <span class="number">62</span> </span><br><span class="line"> <span class="number">63</span> writer,</span><br><span class="line"> <span class="number">64</span> </span><br><span class="line"> <span class="number">65</span>  loggingEvent.Repository,</span><br><span class="line"> <span class="number">66</span> </span><br><span class="line"> <span class="number">67</span>  LookupProperty(Option,</span><br><span class="line"> <span class="number">68</span> </span><br><span class="line"> <span class="number">69</span>  loggingEvent)</span><br><span class="line"> <span class="number">70</span> </span><br><span class="line"> <span class="number">71</span> );</span><br><span class="line"> <span class="number">72</span> </span><br><span class="line"> <span class="number">73</span>             &#125;</span><br><span class="line"> <span class="number">74</span> </span><br><span class="line"> <span class="number">75</span>             <span class="keyword">else</span></span><br><span class="line"> <span class="number">76</span> </span><br><span class="line"> <span class="number">77</span>             &#123;</span><br><span class="line"> <span class="number">78</span> </span><br><span class="line"> <span class="number">79</span>                 <span class="comment">// 写入所有关键值对</span></span><br><span class="line"> <span class="number">80</span> </span><br><span class="line"> <span class="number">81</span>                 WriteDictionary(</span><br><span class="line"> <span class="number">82</span> </span><br><span class="line"> <span class="number">83</span> writer,</span><br><span class="line"> <span class="number">84</span> </span><br><span class="line"> <span class="number">85</span> loggingEvent.Repository,</span><br><span class="line"> <span class="number">86</span> </span><br><span class="line"> <span class="number">87</span>  loggingEvent.GetProperties()</span><br><span class="line"> <span class="number">88</span> </span><br><span class="line"> <span class="number">89</span> );</span><br><span class="line"> <span class="number">90</span> </span><br><span class="line"> <span class="number">91</span>             &#125;</span><br><span class="line"> <span class="number">92</span> </span><br><span class="line"> <span class="number">93</span>         &#125;</span><br><span class="line"> <span class="number">94</span> </span><br><span class="line"> <span class="number">95</span>  </span><br><span class="line"> <span class="number">96</span> </span><br><span class="line"> <span class="number">97</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"> <span class="number">98</span> </span><br><span class="line"> <span class="number">99</span>         <span class="comment"><span class="doctag">///</span> 通过反射获取传入的日志对象的某个属性的值</span></span><br><span class="line"><span class="number">100</span> </span><br><span class="line"><span class="number">101</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="number">102</span> </span><br><span class="line"><span class="number">103</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;property&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="number">104</span> </span><br><span class="line"><span class="number">105</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="number">106</span> </span><br><span class="line"><span class="number">107</span>         <span class="function"><span class="keyword">private</span> <span class="keyword">object</span> <span class="title">LookupProperty</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">108</span> </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">109</span> <span class="keyword">string</span> property,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">110</span> </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">111</span>  log4net.Core.LoggingEvent loggingEvent</span>)</span></span><br><span class="line"><span class="function">112 </span></span><br><span class="line"><span class="function">113</span>         &#123;</span><br><span class="line"><span class="number">114</span> </span><br><span class="line"><span class="number">115</span>             <span class="keyword">object</span> propertyValue = <span class="keyword">string</span>.Empty;</span><br><span class="line"><span class="number">116</span> </span><br><span class="line"><span class="number">117</span>  </span><br><span class="line"><span class="number">118</span> </span><br><span class="line"><span class="number">119</span>             PropertyInfo propertyInfo =</span><br><span class="line"><span class="number">120</span> </span><br><span class="line"><span class="number">121</span> loggingEvent.MessageObject.GetType().GetProperty(property);</span><br><span class="line"><span class="number">122</span> </span><br><span class="line"><span class="number">123</span>             <span class="keyword">if</span> (propertyInfo != <span class="literal">null</span>)</span><br><span class="line"><span class="number">124</span> </span><br><span class="line"><span class="number">125</span>             &#123;</span><br><span class="line"><span class="number">126</span> </span><br><span class="line"><span class="number">127</span>                 propertyValue =</span><br><span class="line"><span class="number">128</span> </span><br><span class="line"><span class="number">129</span> propertyInfo.GetValue(loggingEvent.MessageObject, <span class="literal">null</span>);</span><br><span class="line"><span class="number">130</span> </span><br><span class="line"><span class="number">131</span>             &#125;</span><br><span class="line"><span class="number">132</span> </span><br><span class="line"><span class="number">133</span>             <span class="keyword">return</span> propertyValue;</span><br><span class="line"><span class="number">134</span> </span><br><span class="line"><span class="number">135</span>         &#125;</span><br><span class="line"><span class="number">136</span> </span><br><span class="line"><span class="number">137</span>     &#125;</span><br><span class="line"><span class="number">138</span> </span><br><span class="line"><span class="number">139</span> &#125;</span><br></pre></td></tr></table></figure>



<h3 id="8-3-MyLogImpl类代码"><a href="#8-3-MyLogImpl类代码" class="headerlink" title="8.3 MyLogImpl类代码"></a>8.3 MyLogImpl类代码</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br></pre></td><td class="code"><pre><span class="line">  <span class="number">1</span> <span class="keyword">using</span> System;</span><br><span class="line">  <span class="number">2</span> </span><br><span class="line">  <span class="number">3</span> <span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line">  <span class="number">4</span> </span><br><span class="line">  <span class="number">5</span> <span class="keyword">using</span> System.Linq;</span><br><span class="line">  <span class="number">6</span> </span><br><span class="line">  <span class="number">7</span> <span class="keyword">using</span> System.Text;</span><br><span class="line">  <span class="number">8</span> </span><br><span class="line">  <span class="number">9</span> <span class="keyword">using</span> log4net.Core;</span><br><span class="line"> <span class="number">10</span> </span><br><span class="line"> <span class="number">11</span>  </span><br><span class="line"> <span class="number">12</span> </span><br><span class="line"> <span class="number">13</span> <span class="keyword">namespace</span> <span class="title">TGLog.ExpandILog</span></span><br><span class="line"> 14 </span><br><span class="line"> <span class="number">15</span> &#123;</span><br><span class="line"> <span class="number">16</span> </span><br><span class="line"> <span class="number">17</span>     <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyLogImpl</span> : <span class="title">LogImpl</span>, <span class="title">IMyLog</span></span><br><span class="line"> 18 </span><br><span class="line"> <span class="number">19</span>     &#123;</span><br><span class="line"> <span class="number">20</span> </span><br><span class="line"> <span class="number">21</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"> <span class="number">22</span> </span><br><span class="line"> <span class="number">23</span>         <span class="comment"><span class="doctag">///</span> The fully qualified name of this declaring type not the type of any subclass.</span></span><br><span class="line"> <span class="number">24</span> </span><br><span class="line"> <span class="number">25</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"> <span class="number">26</span> </span><br><span class="line"> <span class="number">27</span>         <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="keyword">static</span> Type ThisDeclaringType = <span class="keyword">typeof</span>(MyLogImpl);</span><br><span class="line"> <span class="number">28</span> </span><br><span class="line"> <span class="number">29</span>  </span><br><span class="line"> <span class="number">30</span> </span><br><span class="line"> <span class="number">31</span>         <span class="function"><span class="keyword">public</span> <span class="title">MyLogImpl</span>(<span class="params">ILogger logger</span>)</span></span><br><span class="line"><span class="function"> 32 </span></span><br><span class="line"><span class="function"> 33             : <span class="title">base</span>(<span class="params">logger</span>)</span></span><br><span class="line"><span class="function"> 34 </span></span><br><span class="line"><span class="function"> 35</span>         &#123;       </span><br><span class="line"> <span class="number">36</span> </span><br><span class="line"> <span class="number">37</span>         &#125;</span><br><span class="line"> <span class="number">38</span> </span><br><span class="line"> <span class="number">39</span>  </span><br><span class="line"> <span class="number">40</span> </span><br><span class="line"> <span class="number">41</span>         <span class="meta">#<span class="meta-keyword">region</span> Implementation of IMyLog</span></span><br><span class="line"> <span class="number">42</span> </span><br><span class="line"> <span class="number">43</span>  </span><br><span class="line"> <span class="number">44</span> </span><br><span class="line"> <span class="number">45</span>         <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Debug</span>(<span class="params"><span class="keyword">int</span> operatorID, <span class="keyword">string</span> operand, <span class="keyword">int</span> actionType,<span class="keyword">object</span> message,</span></span></span><br><span class="line"><span class="function"><span class="params"> <span class="number">46</span> </span></span></span><br><span class="line"><span class="function"><span class="params"> <span class="number">47</span>  <span class="keyword">string</span> ip, <span class="keyword">string</span> browser, <span class="keyword">string</span> machineName</span>)</span></span><br><span class="line"><span class="function"> 48 </span></span><br><span class="line"><span class="function"> 49</span>         &#123;</span><br><span class="line"> <span class="number">50</span> </span><br><span class="line"> <span class="number">51</span>             Debug(operatorID,  operand,  actionType, message,</span><br><span class="line"> <span class="number">52</span> </span><br><span class="line"> <span class="number">53</span>   ip,  browser, machineName, <span class="literal">null</span>);</span><br><span class="line"> <span class="number">54</span> </span><br><span class="line"> <span class="number">55</span>         &#125;</span><br><span class="line"> <span class="number">56</span> </span><br><span class="line"> <span class="number">57</span>  </span><br><span class="line"> <span class="number">58</span> </span><br><span class="line"> <span class="number">59</span>         <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Debug</span>(<span class="params"><span class="keyword">int</span> operatorID, <span class="keyword">string</span> operand, <span class="keyword">int</span> actionType,<span class="keyword">object</span> message,</span></span></span><br><span class="line"><span class="function"><span class="params"> <span class="number">60</span> </span></span></span><br><span class="line"><span class="function"><span class="params"> <span class="number">61</span> <span class="keyword">string</span> ip, <span class="keyword">string</span> browser, <span class="keyword">string</span> machineName, System.Exception t</span>)</span></span><br><span class="line"><span class="function"> 62 </span></span><br><span class="line"><span class="function"> 63</span>         &#123;</span><br><span class="line"> <span class="number">64</span> </span><br><span class="line"> <span class="number">65</span>             <span class="keyword">if</span> (<span class="keyword">this</span>.IsDebugEnabled)</span><br><span class="line"> <span class="number">66</span> </span><br><span class="line"> <span class="number">67</span>             &#123;</span><br><span class="line"> <span class="number">68</span> </span><br><span class="line"> <span class="number">69</span>                 LoggingEvent loggingEvent =</span><br><span class="line"> <span class="number">70</span> </span><br><span class="line"> <span class="number">71</span> <span class="keyword">new</span> LoggingEvent(ThisDeclaringType, Logger.Repository,</span><br><span class="line"> <span class="number">72</span> </span><br><span class="line"> <span class="number">73</span>                                        Logger.Name, Level.Info, message, t);</span><br><span class="line"> <span class="number">74</span> </span><br><span class="line"> <span class="number">75</span>                 loggingEvent.Properties[<span class="string">&quot;Operator&quot;</span>] = operatorID;</span><br><span class="line"> <span class="number">76</span> </span><br><span class="line"> <span class="number">77</span>                 loggingEvent.Properties[<span class="string">&quot;Operand&quot;</span>] = operand;</span><br><span class="line"> <span class="number">78</span> </span><br><span class="line"> <span class="number">79</span>                 loggingEvent.Properties[<span class="string">&quot;ActionType&quot;</span>] = actionType;</span><br><span class="line"> <span class="number">80</span> </span><br><span class="line"> <span class="number">81</span>                 loggingEvent.Properties[<span class="string">&quot;IP&quot;</span>] = ip;</span><br><span class="line"> <span class="number">82</span> </span><br><span class="line"> <span class="number">83</span>                 loggingEvent.Properties[<span class="string">&quot;Browser&quot;</span>] = browser;</span><br><span class="line"> <span class="number">84</span> </span><br><span class="line"> <span class="number">85</span>                 loggingEvent.Properties[<span class="string">&quot;MachineName&quot;</span>] = machineName;</span><br><span class="line"> <span class="number">86</span> </span><br><span class="line"> <span class="number">87</span>                 Logger.Log(loggingEvent);</span><br><span class="line"> <span class="number">88</span> </span><br><span class="line"> <span class="number">89</span>             &#125;</span><br><span class="line"> <span class="number">90</span> </span><br><span class="line"> <span class="number">91</span>         &#125;</span><br><span class="line"> <span class="number">92</span> </span><br><span class="line"> <span class="number">93</span>  </span><br><span class="line"> <span class="number">94</span> </span><br><span class="line"> <span class="number">95</span>         <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Info</span>(<span class="params"><span class="keyword">int</span> operatorID, <span class="keyword">string</span> operand, <span class="keyword">int</span> actionType, <span class="keyword">object</span> message,</span></span></span><br><span class="line"><span class="function"><span class="params"> <span class="number">96</span> </span></span></span><br><span class="line"><span class="function"><span class="params"> <span class="number">97</span> <span class="keyword">string</span> ip, <span class="keyword">string</span> browser, <span class="keyword">string</span> machineName</span>)</span></span><br><span class="line"><span class="function"> 98 </span></span><br><span class="line"><span class="function"> 99</span>         &#123;</span><br><span class="line"><span class="number">100</span> </span><br><span class="line"><span class="number">101</span>             Info(operatorID, operand, actionType, message, ip, browser, machineName, <span class="literal">null</span>);</span><br><span class="line"><span class="number">102</span> </span><br><span class="line"><span class="number">103</span>         &#125;</span><br><span class="line"><span class="number">104</span> </span><br><span class="line"><span class="number">105</span>  </span><br><span class="line"><span class="number">106</span> </span><br><span class="line"><span class="number">107</span>         <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Info</span>(<span class="params"><span class="keyword">int</span> operatorID, <span class="keyword">string</span> operand, <span class="keyword">int</span> actionType, <span class="keyword">object</span> message,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">108</span> </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">109</span>  <span class="keyword">string</span> ip, <span class="keyword">string</span> browser, <span class="keyword">string</span> machineName, System.Exception t</span>)</span></span><br><span class="line"><span class="function">110 </span></span><br><span class="line"><span class="function">111</span>         &#123;</span><br><span class="line"><span class="number">112</span> </span><br><span class="line"><span class="number">113</span>             <span class="keyword">if</span> (<span class="keyword">this</span>.IsInfoEnabled)</span><br><span class="line"><span class="number">114</span> </span><br><span class="line"><span class="number">115</span>             &#123;</span><br><span class="line"><span class="number">116</span> </span><br><span class="line"><span class="number">117</span>                 LoggingEvent loggingEvent =</span><br><span class="line"><span class="number">118</span> </span><br><span class="line"><span class="number">119</span>  <span class="keyword">new</span> LoggingEvent(ThisDeclaringType, Logger.Repository,</span><br><span class="line"><span class="number">120</span> </span><br><span class="line"><span class="number">121</span>  Logger.Name, Level.Info, message, t);</span><br><span class="line"><span class="number">122</span> </span><br><span class="line"><span class="number">123</span>                 loggingEvent.Properties[<span class="string">&quot;Operator&quot;</span>] = operatorID;</span><br><span class="line"><span class="number">124</span> </span><br><span class="line"><span class="number">125</span>                 loggingEvent.Properties[<span class="string">&quot;Operand&quot;</span>] = operand;</span><br><span class="line"><span class="number">126</span> </span><br><span class="line"><span class="number">127</span>                 loggingEvent.Properties[<span class="string">&quot;ActionType&quot;</span>] = actionType;</span><br><span class="line"><span class="number">128</span> </span><br><span class="line"><span class="number">129</span>                 loggingEvent.Properties[<span class="string">&quot;IP&quot;</span>] = ip;</span><br><span class="line"><span class="number">130</span> </span><br><span class="line"><span class="number">131</span>                 loggingEvent.Properties[<span class="string">&quot;Browser&quot;</span>] = browser;</span><br><span class="line"><span class="number">132</span> </span><br><span class="line"><span class="number">133</span>                 loggingEvent.Properties[<span class="string">&quot;MachineName&quot;</span>] = machineName;</span><br><span class="line"><span class="number">134</span> </span><br><span class="line"><span class="number">135</span>                 Logger.Log(loggingEvent);</span><br><span class="line"><span class="number">136</span> </span><br><span class="line"><span class="number">137</span>             &#125;</span><br><span class="line"><span class="number">138</span> </span><br><span class="line"><span class="number">139</span>         &#125;</span><br><span class="line"><span class="number">140</span> </span><br><span class="line"><span class="number">141</span>  </span><br><span class="line"><span class="number">142</span> </span><br><span class="line"><span class="number">143</span>         <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Warn</span>(<span class="params"><span class="keyword">int</span> operatorID, <span class="keyword">string</span> operand, <span class="keyword">int</span> actionType, <span class="keyword">object</span> message,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">144</span> </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">145</span> <span class="keyword">string</span> ip, <span class="keyword">string</span> browser, <span class="keyword">string</span> machineName</span>)</span></span><br><span class="line"><span class="function">146 </span></span><br><span class="line"><span class="function">147</span>         &#123;</span><br><span class="line"><span class="number">148</span> </span><br><span class="line"><span class="number">149</span>             Warn(operatorID, operand, actionType, message, ip, browser, machineName, <span class="literal">null</span>);</span><br><span class="line"><span class="number">150</span> </span><br><span class="line"><span class="number">151</span>         &#125;</span><br><span class="line"><span class="number">152</span> </span><br><span class="line"><span class="number">153</span>  </span><br><span class="line"><span class="number">154</span> </span><br><span class="line"><span class="number">155</span>         <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Warn</span>(<span class="params"><span class="keyword">int</span> operatorID, <span class="keyword">string</span> operand, <span class="keyword">int</span> actionType, <span class="keyword">object</span> message,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">156</span> </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">157</span>  <span class="keyword">string</span> ip, <span class="keyword">string</span> browser, <span class="keyword">string</span> machineName, System.Exception t</span>)</span></span><br><span class="line"><span class="function">158 </span></span><br><span class="line"><span class="function">159</span>         &#123;</span><br><span class="line"><span class="number">160</span> </span><br><span class="line"><span class="number">161</span>             <span class="keyword">if</span> (<span class="keyword">this</span>.IsWarnEnabled)</span><br><span class="line"><span class="number">162</span> </span><br><span class="line"><span class="number">163</span>             &#123;</span><br><span class="line"><span class="number">164</span> </span><br><span class="line"><span class="number">165</span>                 LoggingEvent loggingEvent =</span><br><span class="line"><span class="number">166</span> </span><br><span class="line"><span class="number">167</span>  <span class="keyword">new</span> LoggingEvent(ThisDeclaringType, Logger.Repository,</span><br><span class="line"><span class="number">168</span> </span><br><span class="line"><span class="number">169</span> Logger.Name, Level.Info, message, t);</span><br><span class="line"><span class="number">170</span> </span><br><span class="line"><span class="number">171</span>                 loggingEvent.Properties[<span class="string">&quot;Operator&quot;</span>] = operatorID;</span><br><span class="line"><span class="number">172</span> </span><br><span class="line"><span class="number">173</span>                 loggingEvent.Properties[<span class="string">&quot;Operand&quot;</span>] = operand;</span><br><span class="line"><span class="number">174</span> </span><br><span class="line"><span class="number">175</span>                 loggingEvent.Properties[<span class="string">&quot;ActionType&quot;</span>] = actionType;</span><br><span class="line"><span class="number">176</span> </span><br><span class="line"><span class="number">177</span>                 loggingEvent.Properties[<span class="string">&quot;IP&quot;</span>] = ip;</span><br><span class="line"><span class="number">178</span> </span><br><span class="line"><span class="number">179</span>                 loggingEvent.Properties[<span class="string">&quot;Browser&quot;</span>] = browser;</span><br><span class="line"><span class="number">180</span> </span><br><span class="line"><span class="number">181</span>                 loggingEvent.Properties[<span class="string">&quot;MachineName&quot;</span>] = machineName;</span><br><span class="line"><span class="number">182</span> </span><br><span class="line"><span class="number">183</span>                 Logger.Log(loggingEvent);</span><br><span class="line"><span class="number">184</span> </span><br><span class="line"><span class="number">185</span>             &#125;</span><br><span class="line"><span class="number">186</span> </span><br><span class="line"><span class="number">187</span>         &#125;</span><br><span class="line"><span class="number">188</span> </span><br><span class="line"><span class="number">189</span>  </span><br><span class="line"><span class="number">190</span> </span><br><span class="line"><span class="number">191</span>         <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Error</span>(<span class="params"><span class="keyword">int</span> operatorID, <span class="keyword">string</span> operand, <span class="keyword">int</span> actionType, <span class="keyword">object</span> message,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">192</span> </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">193</span> <span class="keyword">string</span> ip, <span class="keyword">string</span> browser, <span class="keyword">string</span> machineName</span>)</span></span><br><span class="line"><span class="function">194 </span></span><br><span class="line"><span class="function">195</span>         &#123;</span><br><span class="line"><span class="number">196</span> </span><br><span class="line"><span class="number">197</span>             Error(operatorID, operand, actionType, message, ip, browser, machineName, <span class="literal">null</span>);</span><br><span class="line"><span class="number">198</span> </span><br><span class="line"><span class="number">199</span>         &#125;</span><br><span class="line"><span class="number">200</span> </span><br><span class="line"><span class="number">201</span>  </span><br><span class="line"><span class="number">202</span> </span><br><span class="line"><span class="number">203</span>         <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Error</span>(<span class="params"><span class="keyword">int</span> operatorID, <span class="keyword">string</span> operand, <span class="keyword">int</span> actionType, <span class="keyword">object</span> message,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">204</span> </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">205</span>  <span class="keyword">string</span> ip, <span class="keyword">string</span> browser, <span class="keyword">string</span> machineName, System.Exception t</span>)</span></span><br><span class="line"><span class="function">206 </span></span><br><span class="line"><span class="function">207</span>         &#123;</span><br><span class="line"><span class="number">208</span> </span><br><span class="line"><span class="number">209</span>             <span class="keyword">if</span> (<span class="keyword">this</span>.IsErrorEnabled)</span><br><span class="line"><span class="number">210</span> </span><br><span class="line"><span class="number">211</span>             &#123;</span><br><span class="line"><span class="number">212</span> </span><br><span class="line"><span class="number">213</span>                 LoggingEvent loggingEvent =</span><br><span class="line"><span class="number">214</span> </span><br><span class="line"><span class="number">215</span>  <span class="keyword">new</span> LoggingEvent(ThisDeclaringType, Logger.Repository,</span><br><span class="line"><span class="number">216</span> </span><br><span class="line"><span class="number">217</span>  Logger.Name, Level.Info, message, t);</span><br><span class="line"><span class="number">218</span> </span><br><span class="line"><span class="number">219</span>                 loggingEvent.Properties[<span class="string">&quot;Operator&quot;</span>] = operatorID;</span><br><span class="line"><span class="number">220</span> </span><br><span class="line"><span class="number">221</span>                 loggingEvent.Properties[<span class="string">&quot;Operand&quot;</span>] = operand;</span><br><span class="line"><span class="number">222</span> </span><br><span class="line"><span class="number">223</span>                 loggingEvent.Properties[<span class="string">&quot;ActionType&quot;</span>] = actionType;</span><br><span class="line"><span class="number">224</span> </span><br><span class="line"><span class="number">225</span>                 loggingEvent.Properties[<span class="string">&quot;IP&quot;</span>] = ip;</span><br><span class="line"><span class="number">226</span> </span><br><span class="line"><span class="number">227</span>                 loggingEvent.Properties[<span class="string">&quot;Browser&quot;</span>] = browser;</span><br><span class="line"><span class="number">228</span> </span><br><span class="line"><span class="number">229</span>                 loggingEvent.Properties[<span class="string">&quot;MachineName&quot;</span>] = machineName;</span><br><span class="line"><span class="number">230</span> </span><br><span class="line"><span class="number">231</span>                 Logger.Log(loggingEvent);</span><br><span class="line"><span class="number">232</span> </span><br><span class="line"><span class="number">233</span>             &#125;</span><br><span class="line"><span class="number">234</span> </span><br><span class="line"><span class="number">235</span>         &#125;</span><br><span class="line"><span class="number">236</span> </span><br><span class="line"><span class="number">237</span>  </span><br><span class="line"><span class="number">238</span> </span><br><span class="line"><span class="number">239</span>         <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Fatal</span>(<span class="params"><span class="keyword">int</span> operatorID, <span class="keyword">string</span> operand, <span class="keyword">int</span> actionType, <span class="keyword">object</span> message,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">240</span> </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">241</span>  <span class="keyword">string</span> ip, <span class="keyword">string</span> browser, <span class="keyword">string</span> machineName</span>)</span></span><br><span class="line"><span class="function">242 </span></span><br><span class="line"><span class="function">243</span>         &#123;</span><br><span class="line"><span class="number">244</span> </span><br><span class="line"><span class="number">245</span>             Fatal(operatorID, operand, actionType, message, ip, browser, machineName, <span class="literal">null</span>);</span><br><span class="line"><span class="number">246</span> </span><br><span class="line"><span class="number">247</span>         &#125;</span><br><span class="line"><span class="number">248</span> </span><br><span class="line"><span class="number">249</span>  </span><br><span class="line"><span class="number">250</span> </span><br><span class="line"><span class="number">251</span>         <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Fatal</span>(<span class="params"><span class="keyword">int</span> operatorID, <span class="keyword">string</span> operand, <span class="keyword">int</span> actionType, <span class="keyword">object</span> message,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">252</span> </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">253</span>  <span class="keyword">string</span> ip, <span class="keyword">string</span> browser, <span class="keyword">string</span> machineName, System.Exception t</span>)</span></span><br><span class="line"><span class="function">254 </span></span><br><span class="line"><span class="function">255</span>         &#123;</span><br><span class="line"><span class="number">256</span> </span><br><span class="line"><span class="number">257</span>             <span class="keyword">if</span> (<span class="keyword">this</span>.IsFatalEnabled)</span><br><span class="line"><span class="number">258</span> </span><br><span class="line"><span class="number">259</span>             &#123;</span><br><span class="line"><span class="number">260</span> </span><br><span class="line"><span class="number">261</span>                 LoggingEvent loggingEvent =</span><br><span class="line"><span class="number">262</span> </span><br><span class="line"><span class="number">263</span>  <span class="keyword">new</span> LoggingEvent(ThisDeclaringType, Logger.Repository,</span><br><span class="line"><span class="number">264</span> </span><br><span class="line"><span class="number">265</span>                                        Logger.Name, Level.Info, message, t);</span><br><span class="line"><span class="number">266</span> </span><br><span class="line"><span class="number">267</span>                 loggingEvent.Properties[<span class="string">&quot;Operator&quot;</span>] = operatorID;</span><br><span class="line"><span class="number">268</span> </span><br><span class="line"><span class="number">269</span>                 loggingEvent.Properties[<span class="string">&quot;Operand&quot;</span>] = operand;</span><br><span class="line"><span class="number">270</span> </span><br><span class="line"><span class="number">271</span>                 loggingEvent.Properties[<span class="string">&quot;ActionType&quot;</span>] = actionType;</span><br><span class="line"><span class="number">272</span> </span><br><span class="line"><span class="number">273</span>                 loggingEvent.Properties[<span class="string">&quot;IP&quot;</span>] = ip;</span><br><span class="line"><span class="number">274</span> </span><br><span class="line"><span class="number">275</span>                 loggingEvent.Properties[<span class="string">&quot;Browser&quot;</span>] = browser;</span><br><span class="line"><span class="number">276</span> </span><br><span class="line"><span class="number">277</span>                 loggingEvent.Properties[<span class="string">&quot;MachineName&quot;</span>] = machineName;</span><br><span class="line"><span class="number">278</span> </span><br><span class="line"><span class="number">279</span>                 Logger.Log(loggingEvent);</span><br><span class="line"><span class="number">280</span> </span><br><span class="line"><span class="number">281</span>             &#125;</span><br><span class="line"><span class="number">282</span> </span><br><span class="line"><span class="number">283</span>         &#125;</span><br><span class="line"><span class="number">284</span> </span><br><span class="line"><span class="number">285</span>         <span class="meta">#<span class="meta-keyword">endregion</span> Implementation of IMyLog</span></span><br><span class="line"><span class="number">286</span> </span><br><span class="line"><span class="number">287</span>     &#125;</span><br><span class="line"><span class="number">288</span> </span><br><span class="line"><span class="number">289</span> &#125;</span><br></pre></td></tr></table></figure>



<h3 id="8-4-MyLogManager类代码"><a href="#8-4-MyLogManager类代码" class="headerlink" title="8.4 MyLogManager类代码"></a>8.4 MyLogManager类代码</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br></pre></td><td class="code"><pre><span class="line">  <span class="number">1</span> <span class="meta">#<span class="meta-keyword">region</span> Copyright &amp; License</span></span><br><span class="line">  <span class="number">2</span> </span><br><span class="line">  <span class="number">3</span> <span class="comment">//</span></span><br><span class="line">  <span class="number">4</span> </span><br><span class="line">  <span class="number">5</span> <span class="comment">// Copyright 2001-2005 The Apache Software Foundation</span></span><br><span class="line">  <span class="number">6</span> </span><br><span class="line">  <span class="number">7</span> <span class="comment">//</span></span><br><span class="line">  <span class="number">8</span> </span><br><span class="line">  <span class="number">9</span> <span class="comment">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></span><br><span class="line"> <span class="number">10</span> </span><br><span class="line"> <span class="number">11</span> <span class="comment">// you may not use this file except in compliance with the License.</span></span><br><span class="line"> <span class="number">12</span> </span><br><span class="line"> <span class="number">13</span> <span class="comment">// You may obtain a copy of the License at</span></span><br><span class="line"> <span class="number">14</span> </span><br><span class="line"> <span class="number">15</span> <span class="comment">//</span></span><br><span class="line"> <span class="number">16</span> </span><br><span class="line"> <span class="number">17</span> <span class="comment">// http://www.apache.org/licenses/LICENSE-2.0</span></span><br><span class="line"> <span class="number">18</span> </span><br><span class="line"> <span class="number">19</span> <span class="comment">//</span></span><br><span class="line"> <span class="number">20</span> </span><br><span class="line"> <span class="number">21</span> <span class="comment">// Unless required by applicable law or agreed to in writing, software</span></span><br><span class="line"> <span class="number">22</span> </span><br><span class="line"> <span class="number">23</span> <span class="comment">// distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></span><br><span class="line"> <span class="number">24</span> </span><br><span class="line"> <span class="number">25</span> <span class="comment">// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></span><br><span class="line"> <span class="number">26</span> </span><br><span class="line"> <span class="number">27</span> <span class="comment">// See the License for the specific language governing permissions and</span></span><br><span class="line"> <span class="number">28</span> </span><br><span class="line"> <span class="number">29</span> <span class="comment">// limitations under the License.</span></span><br><span class="line"> <span class="number">30</span> </span><br><span class="line"> <span class="number">31</span> <span class="comment">//</span></span><br><span class="line"> <span class="number">32</span> </span><br><span class="line"> <span class="number">33</span> <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"> <span class="number">34</span> </span><br><span class="line"> <span class="number">35</span>  </span><br><span class="line"> <span class="number">36</span> </span><br><span class="line"> <span class="number">37</span> <span class="keyword">using</span> System;</span><br><span class="line"> <span class="number">38</span> </span><br><span class="line"> <span class="number">39</span> <span class="keyword">using</span> System.Reflection;</span><br><span class="line"> <span class="number">40</span> </span><br><span class="line"> <span class="number">41</span> <span class="keyword">using</span> System.Collections;</span><br><span class="line"> <span class="number">42</span> </span><br><span class="line"> <span class="number">43</span> <span class="keyword">using</span> log4net;</span><br><span class="line"> <span class="number">44</span> </span><br><span class="line"> <span class="number">45</span> <span class="keyword">using</span> log4net.Core;</span><br><span class="line"> <span class="number">46</span> </span><br><span class="line"> <span class="number">47</span> <span class="keyword">using</span> log4net.Repository;</span><br><span class="line"> <span class="number">48</span> </span><br><span class="line"> <span class="number">49</span> <span class="keyword">using</span> log4net.Repository.Hierarchy;</span><br><span class="line"> <span class="number">50</span> </span><br><span class="line"> <span class="number">51</span>  </span><br><span class="line"> <span class="number">52</span> </span><br><span class="line"> <span class="number">53</span> <span class="keyword">namespace</span> <span class="title">TGLog.ExpandILog</span></span><br><span class="line"> 54 </span><br><span class="line"> <span class="number">55</span> &#123;</span><br><span class="line"> <span class="number">56</span> </span><br><span class="line"> <span class="number">57</span>     <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyLogManager</span></span><br><span class="line"> 58 </span><br><span class="line"> <span class="number">59</span>     &#123;</span><br><span class="line"> <span class="number">60</span> </span><br><span class="line"> <span class="number">61</span>         <span class="meta">#<span class="meta-keyword">region</span> Static Member Variables</span></span><br><span class="line"> <span class="number">62</span> </span><br><span class="line"> <span class="number">63</span>  </span><br><span class="line"> <span class="number">64</span> </span><br><span class="line"> <span class="number">65</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"> <span class="number">66</span> </span><br><span class="line"> <span class="number">67</span>         <span class="comment"><span class="doctag">///</span> The wrapper map to use to hold the <span class="doctag">&lt;see cref=&quot;EventIDLogImpl&quot;/&gt;</span> objects</span></span><br><span class="line"> <span class="number">68</span> </span><br><span class="line"> <span class="number">69</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"> <span class="number">70</span> </span><br><span class="line"> <span class="number">71</span>         <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> WrapperMap s_wrapperMap = <span class="keyword">new</span> WrapperMap(newWrapperCreationHandler(WrapperCreationHandler));</span><br><span class="line"> <span class="number">72</span> </span><br><span class="line"> <span class="number">73</span>  </span><br><span class="line"> <span class="number">74</span> </span><br><span class="line"> <span class="number">75</span>         <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"> <span class="number">76</span> </span><br><span class="line"> <span class="number">77</span>  </span><br><span class="line"> <span class="number">78</span> </span><br><span class="line"> <span class="number">79</span>         <span class="meta">#<span class="meta-keyword">region</span> Constructor</span></span><br><span class="line"> <span class="number">80</span> </span><br><span class="line"> <span class="number">81</span>  </span><br><span class="line"> <span class="number">82</span> </span><br><span class="line"> <span class="number">83</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"> <span class="number">84</span> </span><br><span class="line"> <span class="number">85</span>         <span class="comment"><span class="doctag">///</span> Private constructor to prevent object creation</span></span><br><span class="line"> <span class="number">86</span> </span><br><span class="line"> <span class="number">87</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"> <span class="number">88</span> </span><br><span class="line"> <span class="number">89</span>         <span class="function"><span class="keyword">private</span> <span class="title">MyLogManager</span>(<span class="params"></span>)</span> &#123; &#125;</span><br><span class="line"> <span class="number">90</span> </span><br><span class="line"> <span class="number">91</span>  </span><br><span class="line"> <span class="number">92</span> </span><br><span class="line"> <span class="number">93</span>         <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"> <span class="number">94</span> </span><br><span class="line"> <span class="number">95</span>  </span><br><span class="line"> <span class="number">96</span> </span><br><span class="line"> <span class="number">97</span>         <span class="meta">#<span class="meta-keyword">region</span> Type Specific Manager Methods</span></span><br><span class="line"> <span class="number">98</span> </span><br><span class="line"> <span class="number">99</span>  </span><br><span class="line"><span class="number">100</span> </span><br><span class="line"><span class="number">101</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="number">102</span> </span><br><span class="line"><span class="number">103</span>         <span class="comment"><span class="doctag">///</span> Returns the named logger if it exists</span></span><br><span class="line"><span class="number">104</span> </span><br><span class="line"><span class="number">105</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="number">106</span> </span><br><span class="line"><span class="number">107</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span></span></span><br><span class="line"><span class="number">108</span> </span><br><span class="line"><span class="number">109</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;para&gt;</span>If the named logger exists (in the default hierarchy) then it</span></span><br><span class="line"><span class="number">110</span> </span><br><span class="line"><span class="number">111</span>         <span class="comment"><span class="doctag">///</span> returns a reference to the logger, otherwise it returns</span></span><br><span class="line"><span class="number">112</span> </span><br><span class="line"><span class="number">113</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;c&gt;</span>null<span class="doctag">&lt;/c&gt;</span>.<span class="doctag">&lt;/para&gt;</span></span></span><br><span class="line"><span class="number">114</span> </span><br><span class="line"><span class="number">115</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line"><span class="number">116</span> </span><br><span class="line"><span class="number">117</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;name&quot;&gt;</span>The fully qualified logger name to look for<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="number">118</span> </span><br><span class="line"><span class="number">119</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>The logger found, or null<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="number">120</span> </span><br><span class="line"><span class="number">121</span>         <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IMyLog <span class="title">Exists</span>(<span class="params"><span class="keyword">string</span> name</span>)</span></span><br><span class="line"><span class="function">122 </span></span><br><span class="line"><span class="function">123</span>         &#123;</span><br><span class="line"><span class="number">124</span> </span><br><span class="line"><span class="number">125</span>             <span class="keyword">return</span> Exists(Assembly.GetCallingAssembly(), name);</span><br><span class="line"><span class="number">126</span> </span><br><span class="line"><span class="number">127</span>         &#125;</span><br><span class="line"><span class="number">128</span> </span><br><span class="line"><span class="number">129</span>  </span><br><span class="line"><span class="number">130</span> </span><br><span class="line"><span class="number">131</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="number">132</span> </span><br><span class="line"><span class="number">133</span>         <span class="comment"><span class="doctag">///</span> Returns the named logger if it exists</span></span><br><span class="line"><span class="number">134</span> </span><br><span class="line"><span class="number">135</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="number">136</span> </span><br><span class="line"><span class="number">137</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span></span></span><br><span class="line"><span class="number">138</span> </span><br><span class="line"><span class="number">139</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;para&gt;</span>If the named logger exists (in the specified domain) then it</span></span><br><span class="line"><span class="number">140</span> </span><br><span class="line"><span class="number">141</span>         <span class="comment"><span class="doctag">///</span> returns a reference to the logger, otherwise it returns</span></span><br><span class="line"><span class="number">142</span> </span><br><span class="line"><span class="number">143</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;c&gt;</span>null<span class="doctag">&lt;/c&gt;</span>.<span class="doctag">&lt;/para&gt;</span></span></span><br><span class="line"><span class="number">144</span> </span><br><span class="line"><span class="number">145</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line"><span class="number">146</span> </span><br><span class="line"><span class="number">147</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;domain&quot;&gt;</span>the domain to lookup in<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="number">148</span> </span><br><span class="line"><span class="number">149</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;name&quot;&gt;</span>The fully qualified logger name to look for<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="number">150</span> </span><br><span class="line"><span class="number">151</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>The logger found, or null<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="number">152</span> </span><br><span class="line"><span class="number">153</span>         <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IMyLog <span class="title">Exists</span>(<span class="params"><span class="keyword">string</span> domain, <span class="keyword">string</span> name</span>)</span></span><br><span class="line"><span class="function">154 </span></span><br><span class="line"><span class="function">155</span>         &#123;</span><br><span class="line"><span class="number">156</span> </span><br><span class="line"><span class="number">157</span>             <span class="keyword">return</span> WrapLogger(LoggerManager.Exists(domain, name));</span><br><span class="line"><span class="number">158</span> </span><br><span class="line"><span class="number">159</span>         &#125;</span><br><span class="line"><span class="number">160</span> </span><br><span class="line"><span class="number">161</span>  </span><br><span class="line"><span class="number">162</span> </span><br><span class="line"><span class="number">163</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="number">164</span> </span><br><span class="line"><span class="number">165</span>         <span class="comment"><span class="doctag">///</span> Returns the named logger if it exists</span></span><br><span class="line"><span class="number">166</span> </span><br><span class="line"><span class="number">167</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="number">168</span> </span><br><span class="line"><span class="number">169</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span></span></span><br><span class="line"><span class="number">170</span> </span><br><span class="line"><span class="number">171</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;para&gt;</span>If the named logger exists (in the specified assembly&#x27;s domain) then it</span></span><br><span class="line"><span class="number">172</span> </span><br><span class="line"><span class="number">173</span>         <span class="comment"><span class="doctag">///</span> returns a reference to the logger, otherwise it returns</span></span><br><span class="line"><span class="number">174</span> </span><br><span class="line"><span class="number">175</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;c&gt;</span>null<span class="doctag">&lt;/c&gt;</span>.<span class="doctag">&lt;/para&gt;</span></span></span><br><span class="line"><span class="number">176</span> </span><br><span class="line"><span class="number">177</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line"><span class="number">178</span> </span><br><span class="line"><span class="number">179</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;assembly&quot;&gt;</span>the assembly to use to lookup the domain<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="number">180</span> </span><br><span class="line"><span class="number">181</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;name&quot;&gt;</span>The fully qualified logger name to look for<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="number">182</span> </span><br><span class="line"><span class="number">183</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>The logger found, or null<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="number">184</span> </span><br><span class="line"><span class="number">185</span>         <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IMyLog <span class="title">Exists</span>(<span class="params">Assembly assembly, <span class="keyword">string</span> name</span>)</span></span><br><span class="line"><span class="function">186 </span></span><br><span class="line"><span class="function">187</span>         &#123;</span><br><span class="line"><span class="number">188</span> </span><br><span class="line"><span class="number">189</span>             <span class="keyword">return</span> WrapLogger(LoggerManager.Exists(assembly, name));</span><br><span class="line"><span class="number">190</span> </span><br><span class="line"><span class="number">191</span>         &#125;</span><br><span class="line"><span class="number">192</span> </span><br><span class="line"><span class="number">193</span>  </span><br><span class="line"><span class="number">194</span> </span><br><span class="line"><span class="number">195</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="number">196</span> </span><br><span class="line"><span class="number">197</span>         <span class="comment"><span class="doctag">///</span> Returns all the currently defined loggers in the default domain.</span></span><br><span class="line"><span class="number">198</span> </span><br><span class="line"><span class="number">199</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="number">200</span> </span><br><span class="line"><span class="number">201</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span></span></span><br><span class="line"><span class="number">202</span> </span><br><span class="line"><span class="number">203</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;para&gt;</span>The root logger is <span class="doctag">&lt;b&gt;</span>not<span class="doctag">&lt;/b&gt;</span> included in the returned array.<span class="doctag">&lt;/para&gt;</span></span></span><br><span class="line"><span class="number">204</span> </span><br><span class="line"><span class="number">205</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line"><span class="number">206</span> </span><br><span class="line"><span class="number">207</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>All the defined loggers<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="number">208</span> </span><br><span class="line"><span class="number">209</span>         <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IMyLog[] <span class="title">GetCurrentLoggers</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">210 </span></span><br><span class="line"><span class="function">211</span>         &#123;</span><br><span class="line"><span class="number">212</span> </span><br><span class="line"><span class="number">213</span>             <span class="keyword">return</span> GetCurrentLoggers(Assembly.GetCallingAssembly());</span><br><span class="line"><span class="number">214</span> </span><br><span class="line"><span class="number">215</span>         &#125;</span><br><span class="line"><span class="number">216</span> </span><br><span class="line"><span class="number">217</span>  </span><br><span class="line"><span class="number">218</span> </span><br><span class="line"><span class="number">219</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="number">220</span> </span><br><span class="line"><span class="number">221</span>         <span class="comment"><span class="doctag">///</span> Returns all the currently defined loggers in the specified domain.</span></span><br><span class="line"><span class="number">222</span> </span><br><span class="line"><span class="number">223</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="number">224</span> </span><br><span class="line"><span class="number">225</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;domain&quot;&gt;</span>the domain to lookup in<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="number">226</span> </span><br><span class="line"><span class="number">227</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span></span></span><br><span class="line"><span class="number">228</span> </span><br><span class="line"><span class="number">229</span>         <span class="comment"><span class="doctag">///</span> The root logger is <span class="doctag">&lt;b&gt;</span>not<span class="doctag">&lt;/b&gt;</span> included in the returned array.</span></span><br><span class="line"><span class="number">230</span> </span><br><span class="line"><span class="number">231</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line"><span class="number">232</span> </span><br><span class="line"><span class="number">233</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>All the defined loggers<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="number">234</span> </span><br><span class="line"><span class="number">235</span>         <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IMyLog[] <span class="title">GetCurrentLoggers</span>(<span class="params"><span class="keyword">string</span> domain</span>)</span></span><br><span class="line"><span class="function">236 </span></span><br><span class="line"><span class="function">237</span>         &#123;</span><br><span class="line"><span class="number">238</span> </span><br><span class="line"><span class="number">239</span>             <span class="keyword">return</span> WrapLoggers(LoggerManager.GetCurrentLoggers(domain));</span><br><span class="line"><span class="number">240</span> </span><br><span class="line"><span class="number">241</span>         &#125;</span><br><span class="line"><span class="number">242</span> </span><br><span class="line"><span class="number">243</span>  </span><br><span class="line"><span class="number">244</span> </span><br><span class="line"><span class="number">245</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="number">246</span> </span><br><span class="line"><span class="number">247</span>         <span class="comment"><span class="doctag">///</span> Returns all the currently defined loggers in the specified assembly&#x27;s domain.</span></span><br><span class="line"><span class="number">248</span> </span><br><span class="line"><span class="number">249</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="number">250</span> </span><br><span class="line"><span class="number">251</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;assembly&quot;&gt;</span>the assembly to use to lookup the domain<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="number">252</span> </span><br><span class="line"><span class="number">253</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span></span></span><br><span class="line"><span class="number">254</span> </span><br><span class="line"><span class="number">255</span>         <span class="comment"><span class="doctag">///</span> The root logger is <span class="doctag">&lt;b&gt;</span>not<span class="doctag">&lt;/b&gt;</span> included in the returned array.</span></span><br><span class="line"><span class="number">256</span> </span><br><span class="line"><span class="number">257</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line"><span class="number">258</span> </span><br><span class="line"><span class="number">259</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>All the defined loggers<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="number">260</span> </span><br><span class="line"><span class="number">261</span>         <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IMyLog[] <span class="title">GetCurrentLoggers</span>(<span class="params">Assembly assembly</span>)</span></span><br><span class="line"><span class="function">262 </span></span><br><span class="line"><span class="function">263</span>         &#123;</span><br><span class="line"><span class="number">264</span> </span><br><span class="line"><span class="number">265</span>             <span class="keyword">return</span> WrapLoggers(LoggerManager.GetCurrentLoggers(assembly));</span><br><span class="line"><span class="number">266</span> </span><br><span class="line"><span class="number">267</span>         &#125;</span><br><span class="line"><span class="number">268</span> </span><br><span class="line"><span class="number">269</span>  </span><br><span class="line"><span class="number">270</span> </span><br><span class="line"><span class="number">271</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="number">272</span> </span><br><span class="line"><span class="number">273</span>         <span class="comment"><span class="doctag">///</span> Retrieve or create a named logger.</span></span><br><span class="line"><span class="number">274</span> </span><br><span class="line"><span class="number">275</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="number">276</span> </span><br><span class="line"><span class="number">277</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span></span></span><br><span class="line"><span class="number">278</span> </span><br><span class="line"><span class="number">279</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;para&gt;</span>Retrieve a logger named as the <span class="doctag">&lt;paramref name=&quot;name&quot;/&gt;</span></span></span><br><span class="line"><span class="number">280</span> </span><br><span class="line"><span class="number">281</span>         <span class="comment"><span class="doctag">///</span> parameter. If the named logger already exists, then the</span></span><br><span class="line"><span class="number">282</span> </span><br><span class="line"><span class="number">283</span>         <span class="comment"><span class="doctag">///</span> existing instance will be returned. Otherwise, a new instance is</span></span><br><span class="line"><span class="number">284</span> </span><br><span class="line"><span class="number">285</span>         <span class="comment"><span class="doctag">///</span> created.<span class="doctag">&lt;/para&gt;</span></span></span><br><span class="line"><span class="number">286</span> </span><br><span class="line"><span class="number">287</span>         <span class="comment"><span class="doctag">///</span></span></span><br><span class="line"><span class="number">288</span> </span><br><span class="line"><span class="number">289</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;para&gt;</span>By default, loggers do not have a set level but inherit</span></span><br><span class="line"><span class="number">290</span> </span><br><span class="line"><span class="number">291</span>         <span class="comment"><span class="doctag">///</span> it from the hierarchy. This is one of the central features of</span></span><br><span class="line"><span class="number">292</span> </span><br><span class="line"><span class="number">293</span>         <span class="comment"><span class="doctag">///</span> log4net.<span class="doctag">&lt;/para&gt;</span></span></span><br><span class="line"><span class="number">294</span> </span><br><span class="line"><span class="number">295</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line"><span class="number">296</span> </span><br><span class="line"><span class="number">297</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;name&quot;&gt;</span>The name of the logger to retrieve.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="number">298</span> </span><br><span class="line"><span class="number">299</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>the logger with the name specified<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="number">300</span> </span><br><span class="line"><span class="number">301</span>         <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IMyLog <span class="title">GetLogger</span>(<span class="params"><span class="keyword">string</span> name</span>)</span></span><br><span class="line"><span class="function">302 </span></span><br><span class="line"><span class="function">303</span>         &#123;</span><br><span class="line"><span class="number">304</span> </span><br><span class="line"><span class="number">305</span>             <span class="keyword">return</span> GetLogger(Assembly.GetCallingAssembly(), name);</span><br><span class="line"><span class="number">306</span> </span><br><span class="line"><span class="number">307</span>         &#125;</span><br><span class="line"><span class="number">308</span> </span><br><span class="line"><span class="number">309</span>  </span><br><span class="line"><span class="number">310</span> </span><br><span class="line"><span class="number">311</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="number">312</span> </span><br><span class="line"><span class="number">313</span>         <span class="comment"><span class="doctag">///</span> Retrieve or create a named logger.</span></span><br><span class="line"><span class="number">314</span> </span><br><span class="line"><span class="number">315</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="number">316</span> </span><br><span class="line"><span class="number">317</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span></span></span><br><span class="line"><span class="number">318</span> </span><br><span class="line"><span class="number">319</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;para&gt;</span>Retrieve a logger named as the <span class="doctag">&lt;paramref name=&quot;name&quot;/&gt;</span></span></span><br><span class="line"><span class="number">320</span> </span><br><span class="line"><span class="number">321</span>         <span class="comment"><span class="doctag">///</span> parameter. If the named logger already exists, then the</span></span><br><span class="line"><span class="number">322</span> </span><br><span class="line"><span class="number">323</span>         <span class="comment"><span class="doctag">///</span> existing instance will be returned. Otherwise, a new instance is</span></span><br><span class="line"><span class="number">324</span> </span><br><span class="line"><span class="number">325</span>         <span class="comment"><span class="doctag">///</span> created.<span class="doctag">&lt;/para&gt;</span></span></span><br><span class="line"><span class="number">326</span> </span><br><span class="line"><span class="number">327</span>         <span class="comment"><span class="doctag">///</span></span></span><br><span class="line"><span class="number">328</span> </span><br><span class="line"><span class="number">329</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;para&gt;</span>By default, loggers do not have a set level but inherit</span></span><br><span class="line"><span class="number">330</span> </span><br><span class="line"><span class="number">331</span>         <span class="comment"><span class="doctag">///</span> it from the hierarchy. This is one of the central features of</span></span><br><span class="line"><span class="number">332</span> </span><br><span class="line"><span class="number">333</span>         <span class="comment"><span class="doctag">///</span> log4net.<span class="doctag">&lt;/para&gt;</span></span></span><br><span class="line"><span class="number">334</span> </span><br><span class="line"><span class="number">335</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line"><span class="number">336</span> </span><br><span class="line"><span class="number">337</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;domain&quot;&gt;</span>the domain to lookup in<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="number">338</span> </span><br><span class="line"><span class="number">339</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;name&quot;&gt;</span>The name of the logger to retrieve.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="number">340</span> </span><br><span class="line"><span class="number">341</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>the logger with the name specified<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="number">342</span> </span><br><span class="line"><span class="number">343</span>         <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IMyLog <span class="title">GetLogger</span>(<span class="params"><span class="keyword">string</span> domain, <span class="keyword">string</span> name</span>)</span></span><br><span class="line"><span class="function">344 </span></span><br><span class="line"><span class="function">345</span>         &#123;</span><br><span class="line"><span class="number">346</span> </span><br><span class="line"><span class="number">347</span>             <span class="keyword">return</span> WrapLogger(LoggerManager.GetLogger(domain, name));</span><br><span class="line"><span class="number">348</span> </span><br><span class="line"><span class="number">349</span>         &#125;</span><br><span class="line"><span class="number">350</span> </span><br><span class="line"><span class="number">351</span>  </span><br><span class="line"><span class="number">352</span> </span><br><span class="line"><span class="number">353</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="number">354</span> </span><br><span class="line"><span class="number">355</span>         <span class="comment"><span class="doctag">///</span> Retrieve or create a named logger.</span></span><br><span class="line"><span class="number">356</span> </span><br><span class="line"><span class="number">357</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="number">358</span> </span><br><span class="line"><span class="number">359</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span></span></span><br><span class="line"><span class="number">360</span> </span><br><span class="line"><span class="number">361</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;para&gt;</span>Retrieve a logger named as the <span class="doctag">&lt;paramref name=&quot;name&quot;/&gt;</span></span></span><br><span class="line"><span class="number">362</span> </span><br><span class="line"><span class="number">363</span>         <span class="comment"><span class="doctag">///</span> parameter. If the named logger already exists, then the</span></span><br><span class="line"><span class="number">364</span> </span><br><span class="line"><span class="number">365</span>         <span class="comment"><span class="doctag">///</span> existing instance will be returned. Otherwise, a new instance is</span></span><br><span class="line"><span class="number">366</span> </span><br><span class="line"><span class="number">367</span>         <span class="comment"><span class="doctag">///</span> created.<span class="doctag">&lt;/para&gt;</span></span></span><br><span class="line"><span class="number">368</span> </span><br><span class="line"><span class="number">369</span>         <span class="comment"><span class="doctag">///</span></span></span><br><span class="line"><span class="number">370</span> </span><br><span class="line"><span class="number">371</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;para&gt;</span>By default, loggers do not have a set level but inherit</span></span><br><span class="line"><span class="number">372</span> </span><br><span class="line"><span class="number">373</span>         <span class="comment"><span class="doctag">///</span> it from the hierarchy. This is one of the central features of</span></span><br><span class="line"><span class="number">374</span> </span><br><span class="line"><span class="number">375</span>         <span class="comment"><span class="doctag">///</span> log4net.<span class="doctag">&lt;/para&gt;</span></span></span><br><span class="line"><span class="number">376</span> </span><br><span class="line"><span class="number">377</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line"><span class="number">378</span> </span><br><span class="line"><span class="number">379</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;assembly&quot;&gt;</span>the assembly to use to lookup the domain<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="number">380</span> </span><br><span class="line"><span class="number">381</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;name&quot;&gt;</span>The name of the logger to retrieve.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="number">382</span> </span><br><span class="line"><span class="number">383</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>the logger with the name specified<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="number">384</span> </span><br><span class="line"><span class="number">385</span>         <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IMyLog <span class="title">GetLogger</span>(<span class="params">Assembly assembly, <span class="keyword">string</span> name</span>)</span></span><br><span class="line"><span class="function">386 </span></span><br><span class="line"><span class="function">387</span>         &#123;</span><br><span class="line"><span class="number">388</span> </span><br><span class="line"><span class="number">389</span>             <span class="keyword">return</span> WrapLogger(LoggerManager.GetLogger(assembly, name));</span><br><span class="line"><span class="number">390</span> </span><br><span class="line"><span class="number">391</span>         &#125;</span><br><span class="line"><span class="number">392</span> </span><br><span class="line"><span class="number">393</span>  </span><br><span class="line"><span class="number">394</span> </span><br><span class="line"><span class="number">395</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="number">396</span> </span><br><span class="line"><span class="number">397</span>         <span class="comment"><span class="doctag">///</span> Shorthand for <span class="doctag">&lt;see cref=&quot;LogManager.GetLogger(string)&quot;/&gt;</span>.</span></span><br><span class="line"><span class="number">398</span> </span><br><span class="line"><span class="number">399</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="number">400</span> </span><br><span class="line"><span class="number">401</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span></span></span><br><span class="line"><span class="number">402</span> </span><br><span class="line"><span class="number">403</span>         <span class="comment"><span class="doctag">///</span> Get the logger for the fully qualified name of the type specified.</span></span><br><span class="line"><span class="number">404</span> </span><br><span class="line"><span class="number">405</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line"><span class="number">406</span> </span><br><span class="line"><span class="number">407</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;type&quot;&gt;</span>The full name of <span class="doctag">&lt;paramref name=&quot;type&quot;/&gt;</span> will</span></span><br><span class="line"><span class="number">408</span> </span><br><span class="line"><span class="number">409</span>         <span class="comment"><span class="doctag">///</span> be used as the name of the logger to retrieve.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="number">410</span> </span><br><span class="line"><span class="number">411</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>the logger with the name specified<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="number">412</span> </span><br><span class="line"><span class="number">413</span>         <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IMyLog <span class="title">GetLogger</span>(<span class="params">Type type</span>)</span></span><br><span class="line"><span class="function">414 </span></span><br><span class="line"><span class="function">415</span>         &#123;</span><br><span class="line"><span class="number">416</span> </span><br><span class="line"><span class="number">417</span>             <span class="keyword">return</span> GetLogger(Assembly.GetCallingAssembly(), type.FullName);</span><br><span class="line"><span class="number">418</span> </span><br><span class="line"><span class="number">419</span>         &#125;</span><br><span class="line"><span class="number">420</span> </span><br><span class="line"><span class="number">421</span>  </span><br><span class="line"><span class="number">422</span> </span><br><span class="line"><span class="number">423</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="number">424</span> </span><br><span class="line"><span class="number">425</span>         <span class="comment"><span class="doctag">///</span> Shorthand for <span class="doctag">&lt;see cref=&quot;LogManager.GetLogger(string)&quot;/&gt;</span>.</span></span><br><span class="line"><span class="number">426</span> </span><br><span class="line"><span class="number">427</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="number">428</span> </span><br><span class="line"><span class="number">429</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span></span></span><br><span class="line"><span class="number">430</span> </span><br><span class="line"><span class="number">431</span>         <span class="comment"><span class="doctag">///</span> Get the logger for the fully qualified name of the type specified.</span></span><br><span class="line"><span class="number">432</span> </span><br><span class="line"><span class="number">433</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line"><span class="number">434</span> </span><br><span class="line"><span class="number">435</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;domain&quot;&gt;</span>the domain to lookup in<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="number">436</span> </span><br><span class="line"><span class="number">437</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;type&quot;&gt;</span>The full name of <span class="doctag">&lt;paramref name=&quot;type&quot;/&gt;</span> will</span></span><br><span class="line"><span class="number">438</span> </span><br><span class="line"><span class="number">439</span>         <span class="comment"><span class="doctag">///</span> be used as the name of the logger to retrieve.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="number">440</span> </span><br><span class="line"><span class="number">441</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>the logger with the name specified<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="number">442</span> </span><br><span class="line"><span class="number">443</span>         <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IMyLog <span class="title">GetLogger</span>(<span class="params"><span class="keyword">string</span> domain, Type type</span>)</span></span><br><span class="line"><span class="function">444 </span></span><br><span class="line"><span class="function">445</span>         &#123;</span><br><span class="line"><span class="number">446</span> </span><br><span class="line"><span class="number">447</span>             <span class="keyword">return</span> WrapLogger(LoggerManager.GetLogger(domain, type));</span><br><span class="line"><span class="number">448</span> </span><br><span class="line"><span class="number">449</span>         &#125;</span><br><span class="line"><span class="number">450</span> </span><br><span class="line"><span class="number">451</span>  </span><br><span class="line"><span class="number">452</span> </span><br><span class="line"><span class="number">453</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="number">454</span> </span><br><span class="line"><span class="number">455</span>         <span class="comment"><span class="doctag">///</span> Shorthand for <span class="doctag">&lt;see cref=&quot;LogManager.GetLogger(string)&quot;/&gt;</span>.</span></span><br><span class="line"><span class="number">456</span> </span><br><span class="line"><span class="number">457</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="number">458</span> </span><br><span class="line"><span class="number">459</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span></span></span><br><span class="line"><span class="number">460</span> </span><br><span class="line"><span class="number">461</span>         <span class="comment"><span class="doctag">///</span> Get the logger for the fully qualified name of the type specified.</span></span><br><span class="line"><span class="number">462</span> </span><br><span class="line"><span class="number">463</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line"><span class="number">464</span> </span><br><span class="line"><span class="number">465</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;assembly&quot;&gt;</span>the assembly to use to lookup the domain<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="number">466</span> </span><br><span class="line"><span class="number">467</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;type&quot;&gt;</span>The full name of <span class="doctag">&lt;paramref name=&quot;type&quot;/&gt;</span> will</span></span><br><span class="line"><span class="number">468</span> </span><br><span class="line"><span class="number">469</span>         <span class="comment"><span class="doctag">///</span> be used as the name of the logger to retrieve.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="number">470</span> </span><br><span class="line"><span class="number">471</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>the logger with the name specified<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="number">472</span> </span><br><span class="line"><span class="number">473</span>         <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IMyLog <span class="title">GetLogger</span>(<span class="params">Assembly assembly, Type type</span>)</span></span><br><span class="line"><span class="function">474 </span></span><br><span class="line"><span class="function">475</span>         &#123;</span><br><span class="line"><span class="number">476</span> </span><br><span class="line"><span class="number">477</span>             <span class="keyword">return</span> WrapLogger(LoggerManager.GetLogger(assembly, type));</span><br><span class="line"><span class="number">478</span> </span><br><span class="line"><span class="number">479</span>         &#125;</span><br><span class="line"><span class="number">480</span> </span><br><span class="line"><span class="number">481</span>  </span><br><span class="line"><span class="number">482</span> </span><br><span class="line"><span class="number">483</span>         <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"><span class="number">484</span> </span><br><span class="line"><span class="number">485</span>  </span><br><span class="line"><span class="number">486</span> </span><br><span class="line"><span class="number">487</span>         <span class="meta">#<span class="meta-keyword">region</span> Extension Handlers</span></span><br><span class="line"><span class="number">488</span> </span><br><span class="line"><span class="number">489</span>  </span><br><span class="line"><span class="number">490</span> </span><br><span class="line"><span class="number">491</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="number">492</span> </span><br><span class="line"><span class="number">493</span>         <span class="comment"><span class="doctag">///</span> Lookup the wrapper object for the logger specified</span></span><br><span class="line"><span class="number">494</span> </span><br><span class="line"><span class="number">495</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="number">496</span> </span><br><span class="line"><span class="number">497</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;logger&quot;&gt;</span>the logger to get the wrapper for<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="number">498</span> </span><br><span class="line"><span class="number">499</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>the wrapper for the logger specified<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="number">500</span> </span><br><span class="line"><span class="number">501</span>         <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> IMyLog <span class="title">WrapLogger</span>(<span class="params">ILogger logger</span>)</span></span><br><span class="line"><span class="function">502 </span></span><br><span class="line"><span class="function">503</span>         &#123;</span><br><span class="line"><span class="number">504</span> </span><br><span class="line"><span class="number">505</span>             <span class="keyword">return</span> (IMyLog)s_wrapperMap.GetWrapper(logger);</span><br><span class="line"><span class="number">506</span> </span><br><span class="line"><span class="number">507</span>         &#125;</span><br><span class="line"><span class="number">508</span> </span><br><span class="line"><span class="number">509</span>  </span><br><span class="line"><span class="number">510</span> </span><br><span class="line"><span class="number">511</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="number">512</span> </span><br><span class="line"><span class="number">513</span>         <span class="comment"><span class="doctag">///</span> Lookup the wrapper objects for the loggers specified</span></span><br><span class="line"><span class="number">514</span> </span><br><span class="line"><span class="number">515</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="number">516</span> </span><br><span class="line"><span class="number">517</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;loggers&quot;&gt;</span>the loggers to get the wrappers for<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="number">518</span> </span><br><span class="line"><span class="number">519</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>Lookup the wrapper objects for the loggers specified<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="number">520</span> </span><br><span class="line"><span class="number">521</span>         <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> IMyLog[] <span class="title">WrapLoggers</span>(<span class="params">ILogger[] loggers</span>)</span></span><br><span class="line"><span class="function">522 </span></span><br><span class="line"><span class="function">523</span>         &#123;</span><br><span class="line"><span class="number">524</span> </span><br><span class="line"><span class="number">525</span>             IMyLog[] results = <span class="keyword">new</span> IMyLog[loggers.Length];</span><br><span class="line"><span class="number">526</span> </span><br><span class="line"><span class="number">527</span>             <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; loggers.Length; i++)</span><br><span class="line"><span class="number">528</span> </span><br><span class="line"><span class="number">529</span>             &#123;</span><br><span class="line"><span class="number">530</span> </span><br><span class="line"><span class="number">531</span>                 results[i] = WrapLogger(loggers[i]);</span><br><span class="line"><span class="number">532</span> </span><br><span class="line"><span class="number">533</span>             &#125;</span><br><span class="line"><span class="number">534</span> </span><br><span class="line"><span class="number">535</span>             <span class="keyword">return</span> results;</span><br><span class="line"><span class="number">536</span> </span><br><span class="line"><span class="number">537</span>         &#125;</span><br><span class="line"><span class="number">538</span> </span><br><span class="line"><span class="number">539</span>  </span><br><span class="line"><span class="number">540</span> </span><br><span class="line"><span class="number">541</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="number">542</span> </span><br><span class="line"><span class="number">543</span>         <span class="comment"><span class="doctag">///</span> Method to create the <span class="doctag">&lt;see cref=&quot;ILoggerWrapper&quot;/&gt;</span> objects used by</span></span><br><span class="line"><span class="number">544</span> </span><br><span class="line"><span class="number">545</span>         <span class="comment"><span class="doctag">///</span> this manager.</span></span><br><span class="line"><span class="number">546</span> </span><br><span class="line"><span class="number">547</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="number">548</span> </span><br><span class="line"><span class="number">549</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;logger&quot;&gt;</span>The logger to wrap<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="number">550</span> </span><br><span class="line"><span class="number">551</span>         <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>The wrapper for the logger specified<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="number">552</span> </span><br><span class="line"><span class="number">553</span>         <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> ILoggerWrapper <span class="title">WrapperCreationHandler</span>(<span class="params">ILogger logger</span>)</span></span><br><span class="line"><span class="function">554 </span></span><br><span class="line"><span class="function">555</span>         &#123;</span><br><span class="line"><span class="number">556</span> </span><br><span class="line"><span class="number">557</span>             <span class="keyword">return</span> <span class="keyword">new</span> MyLogImpl(logger);</span><br><span class="line"><span class="number">558</span> </span><br><span class="line"><span class="number">559</span>         &#125;</span><br><span class="line"><span class="number">560</span> </span><br><span class="line"><span class="number">561</span>         <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"><span class="number">562</span> </span><br><span class="line"><span class="number">563</span>     &#125;</span><br><span class="line"><span class="number">564</span> </span><br><span class="line"><span class="number">565</span> &#125;</span><br></pre></td></tr></table></figure>



<h3 id="8-5-IMyLog类代码"><a href="#8-5-IMyLog类代码" class="headerlink" title="8.5 IMyLog类代码"></a>8.5 IMyLog类代码</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1</span> <span class="keyword">using</span> System;</span><br><span class="line"> <span class="number">2</span> </span><br><span class="line"> <span class="number">3</span> <span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"> <span class="number">4</span> </span><br><span class="line"> <span class="number">5</span> <span class="keyword">using</span> System.Linq;</span><br><span class="line"> <span class="number">6</span> </span><br><span class="line"> <span class="number">7</span> <span class="keyword">using</span> System.Text;</span><br><span class="line"> <span class="number">8</span> </span><br><span class="line"> <span class="number">9</span> <span class="keyword">using</span> log4net;</span><br><span class="line"><span class="number">10</span> </span><br><span class="line"><span class="number">11</span>  </span><br><span class="line"><span class="number">12</span> </span><br><span class="line"><span class="number">13</span> <span class="keyword">namespace</span> <span class="title">TGLog.ExpandILog</span></span><br><span class="line">14 </span><br><span class="line"><span class="number">15</span> &#123;</span><br><span class="line"><span class="number">16</span> </span><br><span class="line"><span class="number">17</span>     <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IMyLog</span> : <span class="title">ILog</span></span><br><span class="line">18 </span><br><span class="line"><span class="number">19</span>     &#123;</span><br><span class="line"><span class="number">20</span> </span><br><span class="line"><span class="number">21</span>         <span class="function"><span class="keyword">void</span> <span class="title">Debug</span>(<span class="params"><span class="keyword">int</span> operatorID, <span class="keyword">string</span> operand, <span class="keyword">int</span> actionType, <span class="keyword">object</span> message,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">22</span> </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">23</span> <span class="keyword">string</span> ip, <span class="keyword">string</span> browser, <span class="keyword">string</span> machineName</span>)</span>;</span><br><span class="line"><span class="number">24</span> </span><br><span class="line"><span class="number">25</span>         <span class="function"><span class="keyword">void</span> <span class="title">Debug</span>(<span class="params"><span class="keyword">int</span> operatorID, <span class="keyword">string</span> operand, <span class="keyword">int</span> actionType,<span class="keyword">object</span> message,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">26</span> </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">27</span> <span class="keyword">string</span> ip, <span class="keyword">string</span> browser, <span class="keyword">string</span> machineName, Exception t</span>)</span>;</span><br><span class="line"><span class="number">28</span> </span><br><span class="line"><span class="number">29</span>  </span><br><span class="line"><span class="number">30</span> </span><br><span class="line"><span class="number">31</span>         <span class="function"><span class="keyword">void</span> <span class="title">Info</span>(<span class="params"><span class="keyword">int</span> operatorID, <span class="keyword">string</span> operand, <span class="keyword">int</span> actionType, <span class="keyword">object</span> message,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">32</span> </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">33</span> <span class="keyword">string</span> ip, <span class="keyword">string</span> browser, <span class="keyword">string</span> machineName</span>)</span>;</span><br><span class="line"><span class="number">34</span> </span><br><span class="line"><span class="number">35</span>         <span class="function"><span class="keyword">void</span> <span class="title">Info</span>(<span class="params"><span class="keyword">int</span> operatorID, <span class="keyword">string</span> operand, <span class="keyword">int</span> actionType, <span class="keyword">object</span> message,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">36</span> </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">37</span> <span class="keyword">string</span> ip, <span class="keyword">string</span> browser, <span class="keyword">string</span> machineName, Exception t</span>)</span>;</span><br><span class="line"><span class="number">38</span> </span><br><span class="line"><span class="number">39</span>  </span><br><span class="line"><span class="number">40</span> </span><br><span class="line"><span class="number">41</span>         <span class="function"><span class="keyword">void</span> <span class="title">Warn</span>(<span class="params"><span class="keyword">int</span> operatorID, <span class="keyword">string</span> operand, <span class="keyword">int</span> actionType, <span class="keyword">object</span> message,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">42</span> </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">43</span> <span class="keyword">string</span> ip, <span class="keyword">string</span> browser, <span class="keyword">string</span> machineName</span>)</span>;</span><br><span class="line"><span class="number">44</span> </span><br><span class="line"><span class="number">45</span>         <span class="function"><span class="keyword">void</span> <span class="title">Warn</span>(<span class="params"><span class="keyword">int</span> operatorID, <span class="keyword">string</span> operand, <span class="keyword">int</span> actionType, <span class="keyword">object</span> message,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">46</span> </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">47</span>  <span class="keyword">string</span> ip, <span class="keyword">string</span> browser, <span class="keyword">string</span> machineName, Exception t</span>)</span>;</span><br><span class="line"><span class="number">48</span> </span><br><span class="line"><span class="number">49</span>  </span><br><span class="line"><span class="number">50</span> </span><br><span class="line"><span class="number">51</span>         <span class="function"><span class="keyword">void</span> <span class="title">Error</span>(<span class="params"><span class="keyword">int</span> operatorID, <span class="keyword">string</span> operand, <span class="keyword">int</span> actionType, <span class="keyword">object</span> message,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">52</span> </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">53</span> <span class="keyword">string</span> ip, <span class="keyword">string</span> browser, <span class="keyword">string</span> machineName</span>)</span>;</span><br><span class="line"><span class="number">54</span> </span><br><span class="line"><span class="number">55</span>         <span class="function"><span class="keyword">void</span> <span class="title">Error</span>(<span class="params"><span class="keyword">int</span> operatorID, <span class="keyword">string</span> operand, <span class="keyword">int</span> actionType, <span class="keyword">object</span> message,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">56</span> </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">57</span> <span class="keyword">string</span> ip, <span class="keyword">string</span> browser, <span class="keyword">string</span> machineName, Exception t</span>)</span>;</span><br><span class="line"><span class="number">58</span> </span><br><span class="line"><span class="number">59</span>  </span><br><span class="line"><span class="number">60</span> </span><br><span class="line"><span class="number">61</span>         <span class="function"><span class="keyword">void</span> <span class="title">Fatal</span>(<span class="params"><span class="keyword">int</span> operatorID, <span class="keyword">string</span> operand, <span class="keyword">int</span> actionType, <span class="keyword">object</span> message,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">62</span> </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">63</span> <span class="keyword">string</span> ip, <span class="keyword">string</span> browser, <span class="keyword">string</span> machineName</span>)</span>;</span><br><span class="line"><span class="number">64</span> </span><br><span class="line"><span class="number">65</span>         <span class="function"><span class="keyword">void</span> <span class="title">Fatal</span>(<span class="params"><span class="keyword">int</span> operatorID, <span class="keyword">string</span> operand, <span class="keyword">int</span> actionType, <span class="keyword">object</span> message,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">66</span> </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">67</span> <span class="keyword">string</span> ip, <span class="keyword">string</span> browser, <span class="keyword">string</span> machineName, Exception t</span>)</span>;</span><br><span class="line"><span class="number">68</span> </span><br><span class="line"><span class="number">69</span>     &#125;</span><br><span class="line"><span class="number">70</span> </span><br><span class="line"><span class="number">71</span> &#125;</span><br></pre></td></tr></table></figure>



<h3 id="8-6附件"><a href="#8-6附件" class="headerlink" title="8.6附件"></a>8.6附件</h3><p><a target="_blank" rel="noopener" href="https://files.cnblogs.com/longshizhong/%E4%BD%BF%E7%94%A8log4net%E8%AE%B0%E5%BD%95%E6%97%A5%E5%BF%97.rar">log4net记录日志.exe</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/yswenli/p/7363501.html">转载-Log4net使用详细说明</a></p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>花生了什么树
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://www.hongjy.cn/2021/11/13/2021-11-13-Log4net%E4%BD%BF%E7%94%A8%E8%AF%A6%E7%BB%86%E8%AF%B4%E6%98%8E/" title="Log4net使用详细说明">http://www.hongjy.cn/2021/11/13/2021-11-13-Log4net使用详细说明/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/11/13/2021-11-13-NET%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E7%9A%84%E8%89%BA%E6%9C%AF/" rel="prev" title="NET单元测试的艺术-nunit">
      <i class="fa fa-chevron-left"></i> NET单元测试的艺术-nunit
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/11/13/2021-11-13-Json-net%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/" rel="next" title="Json.net快速入门">
      Json.net快速入门 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1%E3%80%81%E6%A6%82%E8%BF%B0"><span class="nav-number">1.</span> <span class="nav-text">1、概述</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2%E3%80%81%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E4%BD%BF%E7%94%A8%E5%AE%9E%E4%BE%8B"><span class="nav-number">2.</span> <span class="nav-text">2、一个简单的使用实例</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3%E3%80%81Log4net%E7%9A%84%E4%B8%BB%E8%A6%81%E7%BB%84%E6%88%90%E9%83%A8%E5%88%86"><span class="nav-number">3.</span> <span class="nav-text">3、Log4net的主要组成部分</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-Appenders"><span class="nav-number">3.1.</span> <span class="nav-text">3.1 Appenders</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-Filters"><span class="nav-number">3.2.</span> <span class="nav-text">3.2 Filters</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3-Layouts"><span class="nav-number">3.3.</span> <span class="nav-text">3.3 Layouts</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4-Loggers"><span class="nav-number">3.4.</span> <span class="nav-text">3.4 Loggers</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-5-Object-Renders"><span class="nav-number">3.5.</span> <span class="nav-text">3.5 Object Renders</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-6-Repository"><span class="nav-number">3.6.</span> <span class="nav-text">3.6 Repository</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4%E3%80%81%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3"><span class="nav-number">4.</span> <span class="nav-text">4、配置文件详解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90"><span class="nav-number">4.1.</span> <span class="nav-text">4.1 配置文件构成</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-1"><span class="nav-number">4.1.1.</span> <span class="nav-text">4.1.1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-2"><span class="nav-number">4.1.2.</span> <span class="nav-text">4.1.2 </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-3"><span class="nav-number">4.1.3.</span> <span class="nav-text">4.1.3 </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-4"><span class="nav-number">4.1.4.</span> <span class="nav-text">4.1.4 </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-5"><span class="nav-number">4.1.5.</span> <span class="nav-text">4.1.5 </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-6"><span class="nav-number">4.1.6.</span> <span class="nav-text">4.1.6 </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-7"><span class="nav-number">4.1.7.</span> <span class="nav-text">4.1.7 </span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-%E9%85%8D%E7%BD%AE"><span class="nav-number">4.2.</span> <span class="nav-text">4.2 配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-1%E5%86%99%E5%85%A5%E5%9B%9E%E6%BB%9A%E6%96%87%E4%BB%B6"><span class="nav-number">4.2.1.</span> <span class="nav-text">4.2.1写入回滚文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-1%E5%86%99%E5%85%A5SQL%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">4.2.2.</span> <span class="nav-text">4.2.1写入SQL数据库</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="nav-number">4.3.</span> <span class="nav-text">4.3的配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-4%E5%85%B3%E8%81%94%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">4.4.</span> <span class="nav-text">4.4关联配置文件</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5%E3%80%81%E5%A6%82%E4%BD%95%E8%AE%B0%E5%BD%95%E6%97%A5%E5%BF%97"><span class="nav-number">5.</span> <span class="nav-text">5、如何记录日志</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6%E3%80%81Log4net%E7%9A%84%E7%AE%80%E5%8D%95%E6%89%A9%E5%B1%95"><span class="nav-number">6.</span> <span class="nav-text">6、Log4net的简单扩展</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#6-1%E9%80%9A%E8%BF%87%E9%87%8D%E5%86%99%E5%B8%83%E5%B1%80Layout%E8%BE%93%E5%87%BA%E4%BC%A0%E5%85%A5%E7%9A%84-message%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%B1%9E%E6%80%A7"><span class="nav-number">6.1.</span> <span class="nav-text">6.1通过重写布局Layout输出传入的 message对象的属性</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-1%E9%87%8D%E5%86%99Layout%E7%B1%BB"><span class="nav-number">6.1.1.</span> <span class="nav-text">6.1.1重写Layout类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-2%E9%85%8D%E7%BD%AE%E7%9B%B8%E5%BA%94%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">6.1.2.</span> <span class="nav-text">6.1.2配置相应的配置文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-3%E7%A8%8B%E5%BA%8F%E4%B8%AD%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8"><span class="nav-number">6.1.3.</span> <span class="nav-text">6.1.3程序中如何使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-2%E9%80%9A%E8%BF%87%E9%87%8D%E6%96%B0%E5%AE%9E%E7%8E%B0ILog%E6%8E%A5%E5%8F%A3%E6%9D%A5%E5%A2%9E%E5%8A%A0%E8%BE%93%E5%85%A5%E7%9A%84%E5%8F%82%E6%95%B0"><span class="nav-number">6.2.</span> <span class="nav-text">6.2通过重新实现ILog接口来增加输入的参数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-1%E9%87%8D%E5%86%99LogImpl%EF%BC%8CLogManager%E7%B1%BB%E5%8F%8A%E5%AE%9E%E7%8E%B0ILog%E6%8E%A5%E5%8F%A3"><span class="nav-number">6.2.1.</span> <span class="nav-text">6.2.1重写LogImpl，LogManager类及实现ILog接口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-2%E9%85%8D%E7%BD%AE%E7%9B%B8%E5%BA%94%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">6.2.2.</span> <span class="nav-text">6.2.2配置相应的配置文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-3%E7%A8%8B%E5%BA%8F%E4%B8%AD%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8"><span class="nav-number">6.2.3.</span> <span class="nav-text">6.2.3程序中如何使用</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#7%E3%80%81%E6%80%BB%E7%BB%93"><span class="nav-number">7.</span> <span class="nav-text">7、总结</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#8%E3%80%81%E9%99%84%E6%B3%A8%EF%BC%9A"><span class="nav-number">8.</span> <span class="nav-text">8、附注：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#8-1PatterLayout%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E8%A1%A8"><span class="nav-number">8.0.1.</span> <span class="nav-text">8.1PatterLayout格式化字符表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-2Layout%E7%B1%BB%E4%BB%A3%E7%A0%81"><span class="nav-number">8.0.2.</span> <span class="nav-text">8.2Layout类代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-3-MyLogImpl%E7%B1%BB%E4%BB%A3%E7%A0%81"><span class="nav-number">8.0.3.</span> <span class="nav-text">8.3 MyLogImpl类代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-4-MyLogManager%E7%B1%BB%E4%BB%A3%E7%A0%81"><span class="nav-number">8.0.4.</span> <span class="nav-text">8.4 MyLogManager类代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-5-IMyLog%E7%B1%BB%E4%BB%A3%E7%A0%81"><span class="nav-number">8.0.5.</span> <span class="nav-text">8.5 IMyLog类代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-6%E9%99%84%E4%BB%B6"><span class="nav-number">8.0.6.</span> <span class="nav-text">8.6附件</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="花生了什么树"
      src="http://blogimg.hongjy.cn/v2-a6137a264b6b78a3f1bdce115cf7c224_720w.jpg">
  <p class="site-author-name" itemprop="name">花生了什么树</p>
  <div class="site-description" itemprop="description">.NET工程师</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">83</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">34</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/AllenHongjun" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;AllenHongjun" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hongjy1991@gmail.com" title="E-Mail → mailto:hongjy1991@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.google.com/" title="Google → https:&#x2F;&#x2F;www.google.com&#x2F;" rel="noopener" target="_blank"><i class="fab fa-google fa-fw"></i>Google</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/hongjy1991" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;hongjy1991" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://youtube.com/" title="YouTube → https:&#x2F;&#x2F;youtube.com&#x2F;" rel="noopener" target="_blank"><i class="fab fa-youtube fa-fw"></i>YouTube</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://leetcode-cn.com/" title="https:&#x2F;&#x2F;leetcode-cn.com&#x2F;" rel="noopener" target="_blank">leetcode</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://lailin.xyz/" title="https:&#x2F;&#x2F;lailin.xyz&#x2F;" rel="noopener" target="_blank">lailin</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://ciweigg2.github.io/" title="https:&#x2F;&#x2F;ciweigg2.github.io&#x2F;" rel="noopener" target="_blank">ciweigg2</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.itmuch.com/" title="https:&#x2F;&#x2F;www.itmuch.com&#x2F;" rel="noopener" target="_blank">itmuch</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://tengj.top/" title="http:&#x2F;&#x2F;tengj.top&#x2F;" rel="noopener" target="_blank">tengj</a>
        </li>
    </ul>
  </div>

      </div>



    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">浙ICP备18047156号-1 </a>
  </div>

<div class="copyright">
  
  &copy; 2018 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">花生了什么树</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">383k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">5:49</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>

<script src="/js/utils.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  

</body>
</html>
